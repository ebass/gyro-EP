%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gyro-EP/src/gyro_fulladvance.f90
Compiled : 01/19/21  15:35:38
Compiler : Version 9.1.0
Ftnlx    : Version 9.1.0 
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hdynamic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -hnoomp -em
           -J/global/homes/b/bassem/gyro-EP/modules -sreal64 -eD -Ktrap=fp -m1
           -Rbcdps -G0 -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -c gyro_fulladvance.f90
           -I/opt/cray/pe/cce/9.1.0/cce-clang/x86_64/lib/clang/9.0.0/include
           -I/opt/cray/pe/cce/9.1.0/cce/x86_64/include/craylibs -I/usr/include
           -I/usr/include -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -I/opt/cray/pe/libsci/19.06.1/CRAY/9.0/x86_64/include
           -I/opt/cray/pe/mpt/7.7.10/gni/mpich-cray/9.0/include
           -I/opt/cray/pe/hdf5/1.10.5.2/cray/9.0/include
           -I/opt/cray/pe/netcdf/4.6.3.2/cray/9.0/include
           -I/opt/cray/rca/2.2.20-7.0.1.1_4.53__g8e3fb5b.ari/include
           -I/opt/cray/alps/6.6.58-7.0.1.1_6.10__g437d88db.ari/include
           -I/opt/cray/xpmem/2.2.20-7.0.1.1_4.14__g0475745.ari/include
           -I/opt/cray/gni-headers/5.0.12.0-7.0.1.1_6.32__g3b1768f.ari/include
           -I/opt/cray/dmapp/7.1.1-7.0.1.1_4.54__g38cf134.ari/include
           -I/opt/cray/pe/pmi/5.0.14/include
           -I/opt/cray/ugni/6.0.14.0-7.0.1.1_7.40__ge78e5b0.ari/include
           -I/opt/cray/udreg/2.3.2-7.0.1.1_3.38__g8175d3d.ari/include
           -I/opt/cray/wlm_detect/1.3.3-7.0.1.1_4.16__g7109084.ari/include
           -I/opt/cray/krca/2.2.6-7.0.1.1_5.39__gb641b12.ari/include
           -I/opt/cray-hss-devel/9.0.0/include
Program
  Units  : GYRO_FULLADVANCE

ftnlx report
------------
Source   : /global/u2/b/bassem/gyro-EP/src/gyro_fulladvance.f90
Date     : 01/19/2021  15:35:39


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    !--------------------------------------------------------
    2.    ! gyro_fulladvance.f90
    3.    !
    4.    ! PURPOSE:
    5.    !  Control routine for a single timestep of length dt.
    6.    !--------------------------------------------------------
    7.    
    8.    subroutine gyro_fulladvance
    9.    
   10.      use gyro_globals
   11.      use gyro_pointers
   12.    
   13.      !----------------------------------------
   14.      implicit none
   15.      !----------------------------------------
   16.    
   17.      h_old(:,:,:,:) = h(:,:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 17 
  A loop starting at line 17 was not vectorized because it contains a call to a subroutine or function on line 17.

   18.    
   19.      h_cap_old2(:,:,:,:) = h_cap_old(:,:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 19 
  A loop starting at line 19 was not vectorized because it contains a call to a subroutine or function on line 19.

   20.      h_cap_old(:,:,:,:)  = h_cap(:,:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 20 
  A loop starting at line 20 was not vectorized because it contains a call to a subroutine or function on line 20.

   21.    
   22.      field_blend_old2(:,:,:) = field_blend_old(:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 22 
  A loop starting at line 22 was not vectorized because it contains a call to a subroutine or function on line 22.

   23.      field_blend_old(:,:,:)  = field_blend(:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 23 
  A loop starting at line 23 was not vectorized because it contains a call to a subroutine or function on line 23.

   24.    
   25.      field_tau_old2(:,:,:,:) = field_tau_old(:,:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 25 
  A loop starting at line 25 was not vectorized because it contains a call to a subroutine or function on line 25.

   26.      field_tau_old(:,:,:,:)  = field_tau(:,:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 26 
  A loop starting at line 26 was not vectorized because it contains a call to a subroutine or function on line 26.

   27.    
   28.      gyro_uv_old2(:,:,:,:,:) = gyro_uv_old(:,:,:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 28 
  A loop starting at line 28 was not vectorized because it contains a call to a subroutine or function on line 28.

   29.      gyro_uv_old(:,:,:,:,:)  = gyro_uv(:,:,:,:,:)
ftn-6262 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 29 
  A loop starting at line 29 was not vectorized because it contains a call to a subroutine or function on line 29.

   30.    
   31.      !----------------------
   32.      ! Start time step cycle
   33.      !----------------------
   34.    
   35.      !------------------------------------------------------
   36.      ! MANAGE pitch-angle scattering:
   37.      !
   38.      if (collision_flag == 1) call gyro_collision_main
   39.      !------------------------------------------------------
   40.    
   41.      !------------------------------------------------------
   42.      ! MANAGE time-integrator
   43.      !
   44.      select case (electron_method) 
   45.    
   46.      case (1,3,4)
   47.    
   48.         ! All species explicit
   49.    
   50.         call gyro_timestep_explicit
   51.    
   52.      case (2)
   53.    
   54.         ! Drift-kinetic electrons
   55.    
   56.         call gyro_timestep_implicit
   57.    
   58.      end select
   59.      !------------------------------------------------------
   60.    
   61.      call gyro_timer_in('Diagnos.-allstep')
   62.    
   63.      call gyro_timestep_error
   64.    
   65.      !------------------------------------------------------
   66.      ! MANAGE diagnostics
   67.      !
   68.      ! * Note that (2,3,4) are called once after making 
   69.      !   initial conditions (gyro_initial_condition).
   70.      !
   71.      ! 1. Compute flux-surface average of (phi,a)
   72.      ! 
   73.      call gyro_field_fluxave
   74.      !
   75.      ! 2. Compute (phi,a) for plotting; we want to call 
   76.      !    gyro_field_plot every timestep because it is 
   77.      !    averaged (with a weight) over every timestep.
   78.      !
   79.      !    To compute E_parallel
   80.      !
   81.      call gyro_field_time_derivative
   82.      !
   83.      !    then 
   84.      !
   85.      call gyro_field_plot
   86.      !
   87.      ! 3. Compute (n,T) moments for plotting if user has 
   88.      !    selected OUTPUT_METHOD > 1.
   89.      !
   90.      call gyro_moments_plot 
   91.      !------------------------------------------------------
   92.    
   93.      !------------------------------------------------------
   94.      ! Increment micro-step counter
   95.      !
   96.      alltime_index = alltime_index+1
   97.      !------------------------------------------------------
   98.    
   99.      !------------------------------------------------------
  100.      ! MANAGE time:
  101.      !
  102.      ! Increment simulation time; this is the actual time 
  103.      ! in the gyrokinetic equation:
  104.      !  
  105.      t_current = t_current+dt
  106.      !------------------------------------------------------
  107.    
  108.      !-------------------------------------------------------------------
  109.      ! MANAGE data output: 
  110.      !
  111.      call gyro_timer_out('Diagnos.-allstep')
  112.      call gyro_timer_in('Diagnos.-datastep')
  113.    
  114.    
  115.      if (modulo(step,time_skip) == 0) then
  116.    
  117.         ! Counter for number of data output events.
  118.         if (modulo(step,time_skip) == 0) then
  119.            data_step = data_step+1
  120.         endif
  121.    
  122.         !------------------------------------------------
  123.         ! Compute nonlinear transfer and turbulent energy 
  124.         !------------------------------------------------
  125.    
  126.         if (n_substep == 0 .and. nonlinear_transfer_flag == 1) then
  127.    
  128.            rhs(:,:,:,:) = (0.0,0.0)
ftn-6263 ftn: VECTOR GYRO_FULLADVANCE, File = gyro_fulladvance.f90, Line = 128 
  A loop starting at line 128 was not vectorized because it contains a reference to a non-vector intrinsic on line 128.

  129.    
  130.            call gyro_rhs_nonlinear
  131.            call gyro_nonlinear_transfer
  132.    
  133.         endif
  134.    
  135.         ! Reset micro-step counter.
  136.    
  137.         alltime_index = 0
  138.    
  139.         ! Main data I/O handler
  140.    
  141.         io_control = 2*output_flag
  142.    
  143.         if (modulo(step,time_skip) == 0) then
  144.            call gyro_write_timedata
  145.         endif
  146.    
  147.         !--------------------------------------------------
  148.         ! Update diffusivity and flux time-record for TGYRO 
  149.         !--------------------------------------------------
  150.    
  151.         ! Restart test:
  152.    
  153.         if (modulo(data_step,restart_data_skip) == 0 &
  154.              .and. restart_method >= 0) then
  155.    
  156.            call gyro_write_restart
  157.    
  158.         endif
  159.    
  160.      endif
  161.    
  162.      call gyro_timer_out('Diagnos.-datastep')
  163.      !-------------------------------------------------------------------
  164.    
  165.      if (debug_flag == 1 .and. i_proc == 0) then
  166.         print '(t2,2(a,i5,3x))','-> step =',step,'data_step =',data_step
  167.         print *,'**[gyro_fulladvance done]'
  168.      endif
  169.    
  170.    end subroutine gyro_fulladvance


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
CHAR(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GYRO_COLLISION_MAIN
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 38, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_FIELD_FLUXAVE
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 73, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_FIELD_PLOT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 85, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_FIELD_TIME_DERIVATIVE
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 81, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_FULLADVANCE
      Defined as:  Subroutine (line 8, file gyro_fulladvance.f90)

      Interface:   None

      Calls:       GYRO_COLLISION_MAIN (Line 38, file gyro_fulladvance.f90)
                   GYRO_TIMESTEP_EXPLICIT (Line 50, file gyro_fulladvance.f90)
                   GYRO_TIMESTEP_IMPLICIT (Line 56, file gyro_fulladvance.f90)
                   GYRO_TIMER_IN (Line 61, file gyro_fulladvance.f90)
                   GYRO_TIMER_IN (Line 112, file gyro_fulladvance.f90)
                   GYRO_TIMESTEP_ERROR (Line 63, file gyro_fulladvance.f90)
                   GYRO_FIELD_FLUXAVE (Line 73, file gyro_fulladvance.f90)
                   GYRO_FIELD_TIME_DERIVATIVE (Line 81, file gyro_fulladvance.f90)
                   GYRO_FIELD_PLOT (Line 85, file gyro_fulladvance.f90)
                   GYRO_MOMENTS_PLOT (Line 90, file gyro_fulladvance.f90)
                   GYRO_TIMER_OUT (Line 111, file gyro_fulladvance.f90)
                   GYRO_TIMER_OUT (Line 162, file gyro_fulladvance.f90)
                   MODULO(Intrinsic) (Line 115, file gyro_fulladvance.f90)
                   MODULO(Intrinsic) (Line 118, file gyro_fulladvance.f90)
                   MODULO(Intrinsic) (Line 143, file gyro_fulladvance.f90)
                   MODULO(Intrinsic) (Line 153, file gyro_fulladvance.f90)
                   GYRO_RHS_NONLINEAR (Line 130, file gyro_fulladvance.f90)
                   GYRO_NONLINEAR_TRANSFER (Line 131, file gyro_fulladvance.f90)
                   GYRO_WRITE_TIMEDATA (Line 144, file gyro_fulladvance.f90)
                   GYRO_WRITE_RESTART (Line 156, file gyro_fulladvance.f90)

        Uses:      GYRO_GLOBALS
                   GYRO_POINTERS

Name  Messages
----  --------
GYRO_GLOBALS
      Defined as:  No definitions.

      Used By:     GYRO_FULLADVANCE

Name  Messages
----  --------
GYRO_MOMENTS_PLOT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 90, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_NONLINEAR_TRANSFER
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 131, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_POINTERS
      Defined as:  No definitions.

      Used By:     GYRO_FULLADVANCE

Name  Messages
----  --------
GYRO_RHS_NONLINEAR
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 130, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_TIMER_IN
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 61, file gyro_fulladvance.f90)
                   GYRO_FULLADVANCE (Line 112, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_TIMER_OUT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 111, file gyro_fulladvance.f90)
                   GYRO_FULLADVANCE (Line 162, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_TIMESTEP_ERROR
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 63, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_TIMESTEP_EXPLICIT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 50, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_TIMESTEP_IMPLICIT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 56, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_WRITE_RESTART
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 156, file gyro_fulladvance.f90)

Name  Messages
----  --------
GYRO_WRITE_TIMEDATA
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 144, file gyro_fulladvance.f90)

Name  Messages
----  --------
MODULO(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_FULLADVANCE (Line 115, file gyro_fulladvance.f90)
                   GYRO_FULLADVANCE (Line 118, file gyro_fulladvance.f90)
                   GYRO_FULLADVANCE (Line 143, file gyro_fulladvance.f90)
                   GYRO_FULLADVANCE (Line 153, file gyro_fulladvance.f90)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
