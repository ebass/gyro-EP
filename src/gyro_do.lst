%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gyro-EP/src/gyro_do.f90
Compiled : 01/19/21  15:57:42
Compiler : Version 9.1.0
Ftnlx    : Version 9.1.0 
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hdynamic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -hnoomp -em
           -J/global/homes/b/bassem/gyro-EP/modules -sreal64 -eD -Ktrap=fp -m1
           -Rbcdps -G0 -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -c gyro_do.f90
           -I/opt/cray/pe/cce/9.1.0/cce-clang/x86_64/lib/clang/9.0.0/include
           -I/opt/cray/pe/cce/9.1.0/cce/x86_64/include/craylibs -I/usr/include
           -I/usr/include -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -I/opt/cray/pe/libsci/19.06.1/CRAY/9.0/x86_64/include
           -I/opt/cray/pe/mpt/7.7.10/gni/mpich-cray/9.0/include
           -I/opt/cray/pe/hdf5/1.10.5.2/cray/9.0/include
           -I/opt/cray/pe/netcdf/4.6.3.2/cray/9.0/include
           -I/opt/cray/rca/2.2.20-7.0.1.1_4.53__g8e3fb5b.ari/include
           -I/opt/cray/alps/6.6.58-7.0.1.1_6.10__g437d88db.ari/include
           -I/opt/cray/xpmem/2.2.20-7.0.1.1_4.14__g0475745.ari/include
           -I/opt/cray/gni-headers/5.0.12.0-7.0.1.1_6.32__g3b1768f.ari/include
           -I/opt/cray/dmapp/7.1.1-7.0.1.1_4.54__g38cf134.ari/include
           -I/opt/cray/pe/pmi/5.0.14/include
           -I/opt/cray/ugni/6.0.14.0-7.0.1.1_7.40__ge78e5b0.ari/include
           -I/opt/cray/udreg/2.3.2-7.0.1.1_3.38__g8175d3d.ari/include
           -I/opt/cray/wlm_detect/1.3.3-7.0.1.1_4.16__g7109084.ari/include
           -I/opt/cray/krca/2.2.6-7.0.1.1_5.39__gb641b12.ari/include
           -I/opt/cray-hss-devel/9.0.0/include
Program
  Units  : GYRO_DO

ftnlx report
------------
Source   : /global/u2/b/bassem/gyro-EP/src/gyro_do.f90
Date     : 01/19/2021  15:57:43


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    !-----------------------------------------------------------------
    2.    ! gyro_do.f90
    3.    !
    4.    ! PURPOSE:
    5.    !  Subroutinized main gyro program. 
    6.    !-----------------------------------------------------------------
    7.    
    8.    subroutine gyro_do
    9.    
   10.      use mpi
   11.      use gyro_globals
   12.      use gyro_pointers
   13.      use gyro_interface
   14.      use math_constants
   15.      use GEO_interface
   16.    
   17.      !--------------------------------------
   18.      implicit none
   19.      !
   20.      logical :: rfe
   21.      !--------------------------------------
   22.    
   23.      ! Begin with clean exit status
   24.      !
   25.      ! gyro_exit_status=0 : success
   26.      ! gyro_exit_status=1 : failure
   27.      ! gyro_exit_status=2 : warning
   28.      !
   29.      runfile = 'out.gyro.run'
   30.      call send_line('[Starting gyro_do.]')
   31.    
   32.      gyro_exit_status  = 0
   33.      gyro_exit_message = 'unset'
   34.    
   35.      ! Prepend path:
   36.      runfile  = trim(path)//trim(baserunfile)
   37.      precfile = trim(path)//trim(baseprecfile)
   38.    
   39.      if (baserunfile == 'out.gyro.run')  then
   40.         if (i_proc==0 .and. output_flag==1) THEN
   41.            inquire(file=trim(runfile),exist=rfe)
   42.            if (.not.rfe) then
   43.               open(unit=1,file=trim(runfile),status='unknown')
   44.               close(1)
   45.            endif
   46.         endif
   47.      endif
   48.    
   49.      ! Dump interface variables to record exact state of GYRO.
   50.      call map_global2interface
   51.      call interfacelocaldump
   52.    
   53.      !--------------------------------------------------------------
   54.      ! Early initializations:
   55.      !
   56.      total_memory  = 0.0
   57.      alltime_index = 0
   58.      cpu_maxindx   = 0
   59.      cpu           = -1.0
ftn-6204 ftn: VECTOR GYRO_DO, File = gyro_do.f90, Line = 59 
  A loop starting at line 59 was vectorized.

   60.      cpu_in        = 0.0
ftn-6204 ftn: VECTOR GYRO_DO, File = gyro_do.f90, Line = 60 
  A loop starting at line 60 was vectorized.

   61.      !
   62.      ! TIMER NOTES: 
   63.      ! - print order follows init. order below,
   64.      ! - strings will be split on '-' character.
   65.      !
   66.      call gyro_timer_init('Field-interp.a')
   67.      call gyro_timer_init('Field-interp.b')
   68.      call gyro_timer_init('Velocity-sum')
   69.      call gyro_timer_init('Field-explicit')
   70.      call gyro_timer_init('Field-implicit')
   71.      call gyro_timer_init('Gyroave-h')
   72.      call gyro_timer_init('Implicit-he')
   73.      call gyro_timer_init('RHS-total')
   74.      call gyro_timer_init('Coll.-step')
   75.      call gyro_timer_init('Coll.-comm')
   76.      call gyro_timer_init('Nonlinear-step')
   77.      call gyro_timer_init('Nonlinear-comm')
   78.      call gyro_timer_init('Diagnos.-allstep')
   79.      call gyro_timer_init('Diagnos.-datastep')
   80.      call gyro_timer_init('Full-step')
   81.      !--------------------------------------------------------------
   82.    
   83.      !----------------------------------------------------------------
   84.      ! If running in eigensolve mode.
   85.      !
   86.      if (linsolve_method == 2) then
   87.         if (nonlinear_flag == 1) then
   88.            if (i_proc==0 .and. gkeigen_j_set==0) then
   89.               print '(a)','INFO: (gyro) Eigensolver unavailable in nonlinear mode.'
   90.            endif
   91.            stop 
   92.         else
   93.            if (i_proc==0 .and. gkeigen_j_set==0) then
   94.               print '(a)', 'INFO: (gyro) GYRO is running in eigensolve mode.'
   95.            endif
   96.            eigensolve_restart_flag = restart_method
   97.            restart_method = 0
   98.            if (electron_method /= 1) then
   99.               electron_method = 4
  100.            endif
  101.         endif
  102.      endif
  103.      !----------------------------------------------------------------
  104.    
  105.      !------------------------------------------------------------
  106.      ! The order of these routines is critical:
  107.      !
  108.      ! Startup timer:
  109.      startup_time = MPI_Wtime()
  110.      !
  111.      ! Sort through and check all combinations of operational modes
  112.      !
  113.      call gyro_select_methods
  114.      !
  115.      ! Set parameters connected with timestepping.
  116.      !
  117.      call gyro_initialize_timestep
  118.      !
  119.      ! Generate poloidal (theta) grid dimensions (no operators yet).
  120.      !
  121.      call gyro_theta_grid
  122.      !
  123.      ! Parallel setup 
  124.      !
  125.      if (gyrotest_flag == 0) then
  126.         call gyro_mpi_grid
  127.      else
  128.         n_n_1     = 1
  129.         i_group_1 = 0
  130.      endif
  131.      !
  132.      ! Read, generate or otherwise construct equilibrium profiles.  If experimental 
  133.      ! profiles are used, GEO will be allocate/deallocated with all settings 
  134.      ! determined in EXPRO.
  135.      !
  136.      call gyro_alloc_profile_sim(1)
  137.      call gyro_profile_init
  138.      !
  139.      ! Construct pitch-angle (lambda) and energy grids
  140.      ! and integration weights using Gauss-Legendre rules:
  141.      !
  142.      call gyro_alloc_velocity(1)
  143.      call gyro_alloc_orbit(1)
  144.    !  STOP  ! EMB 1.19.2021
  145.      !
  146.      ! Set geometry (GEO) library control variables
  147.      !
  148.      GEO_nfourier_in = n_fourier_geo 
  149.      GEO_model_in    = geometry_method
  150.      GEO_signb_in    = -btccw
  151.      call GEO_alloc(1)
  152.    !  STOP ! EMB 1.19.2021
  153.      !
  154.      ! Lambda (pitch-angle) weights (GEO needed again, so just reallocate)
  155.      call gyro_lambda_grid
  156.    !  STOP ! EMB 1.19.2021
  157.      !
  158.      ! Energy weights
  159.      !
  160.      call energy_integral(n_energy,energy_max,energy,w_energy)
  161.      STOP  ! EMB 1.19.2021
  162.      !
  163.      ! Compute myriad arrays (for example, map between poloidal
  164.      ! angle and orbit time) for poloidal discretization.
  165.      !
  166.      call gyro_banana_operators
  167.      !
  168.      ! Total velocity-space-tau weights.
  169.      !
  170.      call gyro_set_phase_space(trim(path)//'out.gyro.phase_space',1)
  171.      !
  172.      do i=1,n_x
  173.         call gyro_to_geo(i)
  174.         if (i_proc == 0 .and. i == ir_norm .and. debug_flag == 1) then
  175.            call GEO_write(trim(path)//'out.gyro.geo_diagnostic',1)
  176.         endif
  177.      enddo
  178.      !
  179.      ! Generate geometry-dependent factors using model or Miller equilibrium:
  180.      !
  181.      call gyro_geometry_arrays
  182.      !
  183.      if (gyrotest_flag == 0) then
  184.    
  185.         call gyro_set_pointer_dim
  186.         call gyro_alloc_distrib(1)
  187.    
  188.         ! Make pointers for use with parallelization scheme.
  189.         call gyro_set_pointers
  190.    
  191.         ! Compute drift and diamagnetic frequency coefficients
  192.         ! for GKE solution.
  193.         call gyro_omegas
  194.    
  195.         ! Generate discrete Fourier and Fourier-sine transform 
  196.         ! matrices for spectral Poisson and adaptive source methods, 
  197.         ! compute radial derivative and gyroaverage operators,
  198.         ! and then print them.
  199.    
  200.         call gyro_radial_operators
  201.         !
  202.         ! Precomputation of arrays which depend on blending 
  203.         ! coefficients.  These are used in the Maxwell solves.
  204.         call gyro_set_blend_arrays
  205.    
  206.         if (electron_method == 2) then
  207.    
  208.            ! Make advection operators for electrons
  209.            call gyro_make_implicit_advect(0)
  210.    
  211.         endif
  212.         !
  213.         ! Collision setup (if required; note PNL hook)
  214.         !
  215.         if (collision_flag == 1) then
  216.            call gyro_collision_setup
  217.         endif
  218.    
  219.         !------------------------------------------------------
  220.         ! FIELD MATRICES:
  221.         !
  222.         ! Manage building of field-solve matrices.  Must have 
  223.         ! built the gyro-operators beforehand:
  224.         !
  225.         ! Explicit (Poisson,Ampere)
  226.         !
  227.         select case (n_field)
  228.         case (1)
  229.            call gyro_make_poisson_matrix
  230.         case (2)
  231.            call gyro_make_poisson_matrix
  232.            call gyro_make_ampere_matrix
  233.         case (3)
  234.            call gyro_make_poissonaperp_matrix
  235.            call gyro_make_ampere_matrix
  236.         end select
  237.    
  238.         ! Implicit (Maxwell)
  239.         !
  240.         if (electron_method == 2) then
  241.            call gyro_make_maxwell_matrix
  242.         endif
  243.         !------------------------------------------------------
  244.    
  245.         !------------------------------------------------------
  246.         ! Make a few trivial quantities for the nonlinear step:
  247.         !
  248.         if (nonlinear_flag == 1) then
  249.            call gyro_alloc_nl(1)
  250.            call gyro_nl_setup
  251.         endif
  252.         !
  253.         ! Write information about radial stencils:
  254.         !
  255.         call gyro_write_radial_op(trim(path)//'out.gyro.radial_op',1)
  256.         !
  257.         ! Allocate most large arrays:
  258.         !
  259.         call gyro_alloc_big(1)
  260.         call gyro_initialize_arrays
  261.         !
  262.         ! Make attempt to estimate storage:
  263.         !
  264.         call gyro_memory_usage(trim(path)//'out.gyro.memory',30)
  265.         !
  266.         !------------------------------------------------------------
  267.    
  268.         !------------------------------------------------------------
  269.         ! Open files and write values for t=0:
  270.         !
  271.         call gyro_read_restart
  272.         !------------------------------------------------------------
  273.    
  274.         !---------------------------------------
  275.         ! Write precision data:
  276.         !
  277.         call gyro_write_precision(10,sum(abs(gbflux)))
  278.         !---------------------------------------
  279.    
  280.      endif
  281.    
  282.      startup_time = MPI_Wtime()-startup_time
  283.    
  284.      !---------------------------------------
  285.      ! Dump input parameters runfile
  286.      !
  287.      call gyro_write_input
  288.      !---------------------------------------
  289.    
  290.      !---------------------------------------------------------------
  291.      ! I/O control for time-independent initial data
  292.      !
  293.      call gyro_write_initdata(&
  294.           trim(path)//'out.gyro.profile',&
  295.           trim(path)//'out.gyro.units',&
  296.           trim(path)//'out.gyro.geometry_arrays',1)
  297.      !
  298.      ! Close geometry (GEO) library
  299.      call GEO_alloc(0)
  300.      !---------------------------------------------------------------
  301.    
  302.      !------------------------------------------------------------
  303.      ! By this point, we are finished with running the
  304.      ! 'gyro -t' (test) mode.
  305.      !
  306.      if (gyrotest_flag == 1) then
  307.         call gyro_write_efficiency(trim(path)//'out.gyro.efficiency',1)
  308.         call gyro_set_exit_status('test complete',0)
  309.         return
  310.      endif
  311.      !------------------------------------------------------------
  312.    
  313.      if (restart_method == 0 .or. restart_method == 3) then
  314.         ! Open (new or init)
  315.         io_control = output_flag*1
  316.      else
  317.         ! Rewind (cont)
  318.         io_control = output_flag*3
  319.      endif
  320.      if (gkeigen_j_set == 0) then
  321.         call gyro_write_timedata
  322.      endif
  323.    
  324.      !-------------------------------------------------
  325.      ! NEW SIMULATION ONLY: write *initial conditions*
  326.      !
  327.    
  328.      if (restart_method /= 1) then
  329.         ! Write to output files.
  330.         io_control = output_flag*2
  331.         if (gkeigen_j_set == 0) then
  332.            call gyro_write_timedata
  333.         endif
  334.      endif
  335.      !--------------------------------------------
  336.    
  337.      select case (linsolve_method)
  338.    
  339.      case (1)
  340.    
  341.         !------------------------------
  342.         ! INITIAL VALUE SOLVER
  343.         !------------------------------
  344.    
  345.         !-----------------------------------------------
  346.         ! start time-stepping
  347.    
  348.         do step=1,nstep
  349.    
  350.            call gyro_timer_in('Full-step')
  351.            call gyro_fulladvance
  352.            call gyro_timer_out('Full-step')
  353.    
  354.            !----------------------------------------------------
  355.            ! Check for premature exit conditions
  356.            ! 
  357.            call catch_blowup
  358.            call catch_halt_signal
  359.            if (gyro_exit_status > 0) return
  360.            !
  361.            ! Convergence check for single-n simulation:
  362.            ! freq_err calculated in gyro_write_freq
  363.            !  
  364.            if (freq_err < freq_tol) then
  365.               call gyro_set_exit_status('converged',0)
  366.               return
  367.            endif
  368.            !----------------------------------------------------
  369.    
  370.         enddo
  371.         ! end time-stepping   
  372.         !-----------------------------------------------
  373.    
  374.      case (2)
  375.    
  376.         !------------------------------
  377.         ! GK EIGENVALUE SOLVER
  378.         !------------------------------
  379.    
  380.         ! Determine true range of p_nek_loc for each processor
  381.         n_nek_loc_true = n_nek_1/n_proc_1
  382.         if (i_proc_1 < mod(n_nek_1,n_proc_1) ) then
  383.            n_nek_loc_true = n_nek_loc_true + 1
  384.         endif
  385.         ! Length of total state vector
  386.         h_length = n_kinetic * n_nek_1 * n_x * n_stack
  387.         h_length_loc = n_kinetic * n_nek_loc_true * n_x * n_stack
  388.         h_width_loc = h_length / gkeigen_proc_mult
  389.         h_length_block = h_length_loc / gkeigen_proc_mult
  390.         h_length_block_t = h_width_loc / n_proc
  391.         seq_length = h_length_block * h_width_loc
  392.         seq_length_t = h_length_block_t * h_length_loc
  393.    
  394.         call GKEIGEN_do                                       
  395.    
  396.      case (3)
  397.    
  398.         !------------------------------
  399.         ! FIELD EIGENVALUE SOLVER
  400.         !------------------------------
  401.    
  402.         call gyro_fieldeigen
  403.    
  404.      end select
  405.    
  406.    end subroutine gyro_do


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                     C o m m o n   B l o c k   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Blk  Program Unit                     Messages
---  ------------                     --------
/MPIFCMB5/                            Length: 4 bytes

     GYRO_DO                          Block is used from MPI_CONSTANTS

Blk  Program Unit                     Messages
---  ------------                     --------
/MPIFCMB9/                            Length: 4 bytes

     GYRO_DO                          Block is used from MPI_CONSTANTS

Blk  Program Unit                     Messages
---  ------------                     --------
/MPIPRIV1/                            Length: 28 bytes

     GYRO_DO                          Block is used from MPI_CONSTANTS

Blk  Program Unit                     Messages
---  ------------                     --------
/MPIPRIV2/                            Length: 24 bytes

     GYRO_DO                          Block is used from MPI_CONSTANTS

Blk  Program Unit                     Messages
---  ------------                     --------
/MPIPRIVC/                            Length: 2 bytes

     GYRO_DO                          Block is used from MPI_CONSTANTS


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
ABS(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 277, file gyro_do.f90)

Name  Messages
----  --------
CATCH_BLOWUP
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
CATCH_HALT_SIGNAL
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
CHAR(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
COMMEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
COMMNEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
DATATYPEEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
DATATYPENEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
ENERGY_INTEGRAL
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 160, file gyro_do.f90)

Name  Messages
----  --------
ERRHANDLEREQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
ERRHANDLERNEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
FILEEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
FILENEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GEO_ALLOC
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 151, file gyro_do.f90)
                   GYRO_DO (Line 299, file gyro_do.f90)

Name  Messages
----  --------
GEO_INTERFACE
      Defined as:  No definitions.

      Used By:     GYRO_DO

Name  Messages
----  --------
GEO_WRITE
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 175, file gyro_do.f90)

Name  Messages
----  --------
GKEIGEN_DO
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 394, file gyro_do.f90)

Name  Messages
----  --------
GROUPEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GROUPNEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GYRO_ALLOC_BIG
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 259, file gyro_do.f90)

Name  Messages
----  --------
GYRO_ALLOC_DISTRIB
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 186, file gyro_do.f90)

Name  Messages
----  --------
GYRO_ALLOC_NL
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 249, file gyro_do.f90)

Name  Messages
----  --------
GYRO_ALLOC_ORBIT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 143, file gyro_do.f90)

Name  Messages
----  --------
GYRO_ALLOC_PROFILE_SIM
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 136, file gyro_do.f90)

Name  Messages
----  --------
GYRO_ALLOC_VELOCITY
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 142, file gyro_do.f90)

Name  Messages
----  --------
GYRO_BANANA_OPERATORS
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 166, file gyro_do.f90)

Name  Messages
----  --------
GYRO_COLLISION_SETUP
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 216, file gyro_do.f90)

Name  Messages
----  --------
GYRO_DO
      Defined as:  Subroutine (line 8, file gyro_do.f90)

      Interface:   None

      Calls:       SEND_LINE (Line 30, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 36, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 36, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 37, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 37, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 41, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 43, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 170, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 175, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 255, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 264, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 294, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 295, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 296, file gyro_do.f90)
                   TRIM(Intrinsic) (Line 307, file gyro_do.f90)
                   MAP_GLOBAL2INTERFACE in GYRO_INTERFACE (Line 50, file gyro_do.f90)
                   INTERFACELOCALDUMP in GYRO_INTERFACE (Line 51, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 66, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 67, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 68, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 69, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 70, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 71, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 72, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 73, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 74, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 75, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 76, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 77, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 78, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 79, file gyro_do.f90)
                   GYRO_TIMER_INIT (Line 80, file gyro_do.f90)
                   MPI_WTIME (Line 109, file gyro_do.f90)
                   MPI_WTIME (Line 282, file gyro_do.f90)
                   GYRO_SELECT_METHODS (Line 113, file gyro_do.f90)
                   GYRO_INITIALIZE_TIMESTEP (Line 117, file gyro_do.f90)
                   GYRO_THETA_GRID (Line 121, file gyro_do.f90)
                   GYRO_MPI_GRID (Line 126, file gyro_do.f90)
                   GYRO_ALLOC_PROFILE_SIM (Line 136, file gyro_do.f90)
                   GYRO_PROFILE_INIT (Line 137, file gyro_do.f90)
                   GYRO_ALLOC_VELOCITY (Line 142, file gyro_do.f90)
                   GYRO_ALLOC_ORBIT (Line 143, file gyro_do.f90)
                   GEO_ALLOC (Line 151, file gyro_do.f90)
                   GEO_ALLOC (Line 299, file gyro_do.f90)
                   GYRO_LAMBDA_GRID (Line 155, file gyro_do.f90)
                   ENERGY_INTEGRAL (Line 160, file gyro_do.f90)
                   GYRO_BANANA_OPERATORS (Line 166, file gyro_do.f90)
                   GYRO_SET_PHASE_SPACE (Line 170, file gyro_do.f90)
                   GEO_WRITE (Line 175, file gyro_do.f90)
                   GYRO_SET_POINTER_DIM (Line 185, file gyro_do.f90)
                   GYRO_ALLOC_DISTRIB (Line 186, file gyro_do.f90)
                   GYRO_SET_POINTERS (Line 189, file gyro_do.f90)
                   GYRO_OMEGAS (Line 193, file gyro_do.f90)
                   GYRO_RADIAL_OPERATORS (Line 200, file gyro_do.f90)
                   GYRO_SET_BLEND_ARRAYS (Line 204, file gyro_do.f90)
                   GYRO_MAKE_IMPLICIT_ADVECT (Line 209, file gyro_do.f90)
                   GYRO_COLLISION_SETUP (Line 216, file gyro_do.f90)
                   GYRO_MAKE_POISSON_MATRIX (Line 229, file gyro_do.f90)
                   GYRO_MAKE_POISSON_MATRIX (Line 231, file gyro_do.f90)
                   GYRO_MAKE_AMPERE_MATRIX (Line 232, file gyro_do.f90)
                   GYRO_MAKE_AMPERE_MATRIX (Line 235, file gyro_do.f90)
                   GYRO_MAKE_POISSONAPERP_MATRIX (Line 234, file gyro_do.f90)
                   GYRO_MAKE_MAXWELL_MATRIX (Line 241, file gyro_do.f90)
                   GYRO_ALLOC_NL (Line 249, file gyro_do.f90)
                   GYRO_NL_SETUP (Line 250, file gyro_do.f90)
                   GYRO_WRITE_RADIAL_OP (Line 255, file gyro_do.f90)
                   GYRO_ALLOC_BIG (Line 259, file gyro_do.f90)
                   GYRO_INITIALIZE_ARRAYS (Line 260, file gyro_do.f90)
                   GYRO_MEMORY_USAGE (Line 264, file gyro_do.f90)
                   GYRO_READ_RESTART (Line 271, file gyro_do.f90)
                   ABS(Intrinsic) (Line 277, file gyro_do.f90)
                   SUM(Intrinsic) (Line 277, file gyro_do.f90)
                   GYRO_WRITE_PRECISION (Line 277, file gyro_do.f90)
                   GYRO_WRITE_INPUT (Line 287, file gyro_do.f90)
                   GYRO_WRITE_INITDATA (Line 293, file gyro_do.f90)
                   GYRO_WRITE_EFFICIENCY (Line 307, file gyro_do.f90)
                   GYRO_SET_EXIT_STATUS (Line 308, file gyro_do.f90)
                   GYRO_SET_EXIT_STATUS (Line 365, file gyro_do.f90)
                   GYRO_WRITE_TIMEDATA (Line 321, file gyro_do.f90)
                   GYRO_WRITE_TIMEDATA (Line 332, file gyro_do.f90)
                   MOD(Intrinsic) (Line 382, file gyro_do.f90)
                   GKEIGEN_DO (Line 394, file gyro_do.f90)
                   GYRO_FIELDEIGEN (Line 402, file gyro_do.f90)

        Uses:      MPI
                   MPI_BASE  (indirectly)
                   MPI_SIZEOFS  (indirectly)
                   MPI_CONSTANTS  (indirectly)
                   GYRO_GLOBALS
                   GYRO_POINTERS
                   GYRO_INTERFACE
                   MATH_CONSTANTS
                   GEO_INTERFACE

Name  Messages
----  --------
GYRO_FIELDEIGEN
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 402, file gyro_do.f90)

Name  Messages
----  --------
GYRO_FULLADVANCE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GYRO_GEOMETRY_ARRAYS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GYRO_GLOBALS
      Defined as:  No definitions.

      Used By:     GYRO_DO

Name  Messages
----  --------
GYRO_INITIALIZE_ARRAYS
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 260, file gyro_do.f90)

Name  Messages
----  --------
GYRO_INITIALIZE_TIMESTEP
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 117, file gyro_do.f90)

Name  Messages
----  --------
GYRO_INTERFACE
      Defined as:  No definitions.

      Used By:     GYRO_DO

Name  Messages
----  --------
GYRO_LAMBDA_GRID
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 155, file gyro_do.f90)

Name  Messages
----  --------
GYRO_MAKE_AMPERE_MATRIX
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 232, file gyro_do.f90)
                   GYRO_DO (Line 235, file gyro_do.f90)

Name  Messages
----  --------
GYRO_MAKE_IMPLICIT_ADVECT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 209, file gyro_do.f90)

Name  Messages
----  --------
GYRO_MAKE_MAXWELL_MATRIX
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 241, file gyro_do.f90)

Name  Messages
----  --------
GYRO_MAKE_POISSONAPERP_MATRIX
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 234, file gyro_do.f90)

Name  Messages
----  --------
GYRO_MAKE_POISSON_MATRIX
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 229, file gyro_do.f90)
                   GYRO_DO (Line 231, file gyro_do.f90)

Name  Messages
----  --------
GYRO_MEMORY_USAGE
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 264, file gyro_do.f90)

Name  Messages
----  --------
GYRO_MPI_GRID
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 126, file gyro_do.f90)

Name  Messages
----  --------
GYRO_NL_SETUP
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 250, file gyro_do.f90)

Name  Messages
----  --------
GYRO_OMEGAS
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 193, file gyro_do.f90)

Name  Messages
----  --------
GYRO_POINTERS
      Defined as:  No definitions.

      Used By:     GYRO_DO

Name  Messages
----  --------
GYRO_PROFILE_INIT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 137, file gyro_do.f90)

Name  Messages
----  --------
GYRO_RADIAL_OPERATORS
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 200, file gyro_do.f90)

Name  Messages
----  --------
GYRO_READ_RESTART
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 271, file gyro_do.f90)

Name  Messages
----  --------
GYRO_SELECT_METHODS
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 113, file gyro_do.f90)

Name  Messages
----  --------
GYRO_SET_BLEND_ARRAYS
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 204, file gyro_do.f90)

Name  Messages
----  --------
GYRO_SET_EXIT_STATUS
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 308, file gyro_do.f90)
                   GYRO_DO (Line 365, file gyro_do.f90)

Name  Messages
----  --------
GYRO_SET_PHASE_SPACE
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 170, file gyro_do.f90)

Name  Messages
----  --------
GYRO_SET_POINTERS
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 189, file gyro_do.f90)

Name  Messages
----  --------
GYRO_SET_POINTER_DIM
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 185, file gyro_do.f90)

Name  Messages
----  --------
GYRO_THETA_GRID
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 121, file gyro_do.f90)

Name  Messages
----  --------
GYRO_TIMER_IN
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GYRO_TIMER_INIT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 66, file gyro_do.f90)
                   GYRO_DO (Line 67, file gyro_do.f90)
                   GYRO_DO (Line 68, file gyro_do.f90)
                   GYRO_DO (Line 69, file gyro_do.f90)
                   GYRO_DO (Line 70, file gyro_do.f90)
                   GYRO_DO (Line 71, file gyro_do.f90)
                   GYRO_DO (Line 72, file gyro_do.f90)
                   GYRO_DO (Line 73, file gyro_do.f90)
                   GYRO_DO (Line 74, file gyro_do.f90)
                   GYRO_DO (Line 75, file gyro_do.f90)
                   GYRO_DO (Line 76, file gyro_do.f90)
                   GYRO_DO (Line 77, file gyro_do.f90)
                   GYRO_DO (Line 78, file gyro_do.f90)
                   GYRO_DO (Line 79, file gyro_do.f90)
                   GYRO_DO (Line 80, file gyro_do.f90)

Name  Messages
----  --------
GYRO_TIMER_OUT
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GYRO_TO_GEO
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
GYRO_WRITE_EFFICIENCY
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 307, file gyro_do.f90)

Name  Messages
----  --------
GYRO_WRITE_INITDATA
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 293, file gyro_do.f90)

Name  Messages
----  --------
GYRO_WRITE_INPUT
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 287, file gyro_do.f90)

Name  Messages
----  --------
GYRO_WRITE_PRECISION
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 277, file gyro_do.f90)

Name  Messages
----  --------
GYRO_WRITE_RADIAL_OP
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 255, file gyro_do.f90)

Name  Messages
----  --------
GYRO_WRITE_TIMEDATA
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 321, file gyro_do.f90)
                   GYRO_DO (Line 332, file gyro_do.f90)

Name  Messages
----  --------
INFOEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
INFONEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
INTERFACELOCALDUMP in GYRO_INTERFACE
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 51, file gyro_do.f90)

Name  Messages
----  --------
MAP_GLOBAL2INTERFACE in GYRO_INTERFACE
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 50, file gyro_do.f90)

Name  Messages
----  --------
MAP_INTERFACE2GLOBAL in GYRO_INTERFACE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MATH_CONSTANTS
      Defined as:  No definitions.

      Used By:     GYRO_DO

Name  Messages
----  --------
MESSAGEEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MESSAGENEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MOD(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 382, file gyro_do.f90)

Name  Messages
----  --------
MPI
      Defined as:  No definitions.

      Used By:     GYRO_DO

Name  Messages
----  --------
MPI_BASE
      Defined as:  No definitions.

      Used By:     GYRO_DO  (indirectly)

Name  Messages
----  --------
MPI_CONSTANTS
      Defined as:  No definitions.

      Used By:     GYRO_DO  (indirectly)

Name  Messages
----  --------
MPI_SIZEOFS
      Defined as:  No definitions.

      Used By:     GYRO_DO  (indirectly)

Name  Messages
----  --------
MPI_SIZEOF_CH in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_CHV in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_CX in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_CXV in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_D in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_DV in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_I in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_I1 in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_I1V in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_I2 in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_I2V in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_I8 in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_I8V in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_IV in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_L in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_LV in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_R in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_SIZEOF_RV in MPI_SIZEOFS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
MPI_WTIME
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 109, file gyro_do.f90)
                   GYRO_DO (Line 282, file gyro_do.f90)

Name  Messages
----  --------
OPEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
OPNEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
REQUESTEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
REQUESTNEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
SEND_LINE
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 30, file gyro_do.f90)

Name  Messages
----  --------
SUM(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 277, file gyro_do.f90)

Name  Messages
----  --------
TRIM(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   GYRO_DO (Line 36, file gyro_do.f90)
                   GYRO_DO (Line 36, file gyro_do.f90)
                   GYRO_DO (Line 37, file gyro_do.f90)
                   GYRO_DO (Line 37, file gyro_do.f90)
                   GYRO_DO (Line 41, file gyro_do.f90)
                   GYRO_DO (Line 43, file gyro_do.f90)
                   GYRO_DO (Line 170, file gyro_do.f90)
                   GYRO_DO (Line 175, file gyro_do.f90)
                   GYRO_DO (Line 255, file gyro_do.f90)
                   GYRO_DO (Line 264, file gyro_do.f90)
                   GYRO_DO (Line 294, file gyro_do.f90)
                   GYRO_DO (Line 295, file gyro_do.f90)
                   GYRO_DO (Line 296, file gyro_do.f90)
                   GYRO_DO (Line 307, file gyro_do.f90)

Name  Messages
----  --------
WINEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
WINNEQ in MPI_CONSTANTS
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
_F90_TRIM(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
__SUM(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
