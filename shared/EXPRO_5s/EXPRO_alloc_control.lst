%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gyro-EP/shared/EXPRO/EXPRO_alloc_control.f90
Compiled : 01/14/21  15:27:05
Compiler : Version 9.1.0
Ftnlx    : Version 9.1.0 
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hdynamic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -hnoomp -em
           -J/global/homes/b/bassem/gyro-EP/modules -sreal64 -eD -Ktrap=fp -m1
           -c EXPRO_alloc_control.f90
           -I/opt/cray/pe/cce/9.1.0/cce-clang/x86_64/lib/clang/9.0.0/include
           -I/opt/cray/pe/cce/9.1.0/cce/x86_64/include/craylibs -I/usr/include
           -I/usr/include -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -I/opt/cray/pe/libsci/19.06.1/CRAY/9.0/x86_64/include
           -I/opt/cray/pe/mpt/7.7.10/gni/mpich-cray/9.0/include
           -I/opt/cray/pe/hdf5/1.10.5.2/cray/9.0/include
           -I/opt/cray/pe/netcdf/4.6.3.2/cray/9.0/include
           -I/opt/cray/rca/2.2.20-7.0.1.1_4.53__g8e3fb5b.ari/include
           -I/opt/cray/alps/6.6.58-7.0.1.1_6.10__g437d88db.ari/include
           -I/opt/cray/xpmem/2.2.20-7.0.1.1_4.14__g0475745.ari/include
           -I/opt/cray/gni-headers/5.0.12.0-7.0.1.1_6.32__g3b1768f.ari/include
           -I/opt/cray/dmapp/7.1.1-7.0.1.1_4.54__g38cf134.ari/include
           -I/opt/cray/pe/pmi/5.0.14/include
           -I/opt/cray/ugni/6.0.14.0-7.0.1.1_7.40__ge78e5b0.ari/include
           -I/opt/cray/udreg/2.3.2-7.0.1.1_3.38__g8175d3d.ari/include
           -I/opt/cray/wlm_detect/1.3.3-7.0.1.1_4.16__g7109084.ari/include
           -I/opt/cray/krca/2.2.6-7.0.1.1_5.39__gb641b12.ari/include
           -I/opt/cray-hss-devel/9.0.0/include
Program
  Units  : EXPRO_ALLOC_CONTROL

ftnlx report
------------
Source   : /global/u2/b/bassem/gyro-EP/shared/EXPRO/EXPRO_alloc_control.f90
Date     : 01/14/2021  15:27:05


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    subroutine EXPRO_alloc_control(i_proc,flag)
    2.    
    3.      use EXPRO_globals
    4.      use EXPRO_interface
    5.    
    6.      implicit none
    7.    
    8.      integer, intent(in) :: i_proc
    9.      integer, intent(in) :: flag
   10.    
   11.      integer :: ierr
   12.    
   13.      integer :: EXPRO_n_shot
   14.      integer :: EXPRO_nion_file
   15.    
   16.      integer, parameter :: io=1
   17.    
   18.    
   19.      if (flag == 1) then
   20.    
   21.         if (i_proc == 0 .and. EXPRO_n_exp == 0) then
   22.    
   23.            !--------------------------------------------------------------
   24.            ! Read number of experimental gridpoints:
   25.            ! 
   26.            open(unit=io,&
   27.                 file=trim(path)//'input.profiles.gen',&
   28.                 status='old',&
   29.                 iostat=ierr)
   30.    
   31.            if (ierr == 0) then
   32.               read(io,*) EXPRO_ncol
   33.               read(io,*) EXPRO_nblock
   34.               read(io,*) EXPRO_n_shot
   35.               read(io,*) EXPRO_nion_file
   36.               read(io,*) EXPRO_n_exp
   37.               close(io)
   38.               open(unit=io,file=trim(path)//trim(runfile),status='replace')
   39.               write(io,'(a)') 'INFO: (EXPRO) input.profiles.gen found'
   40.               close(io)
   41.            else
   42.               close(io)
   43.               open(unit=io,file=trim(path)//trim(runfile),status='replace')
   44.               write(io,'(a)') 'ERROR: (EXPRO) input.profiles.gen does not exist'
   45.               close(io)
   46.               stop
   47.            endif
   48.            !--------------------------------------------------------------
   49.    
   50.            !--------------------------------------------------------------
   51.            ! Read number of experimental gridpoints:
   52.            ! 
   53.            open(unit=io,&
   54.                 file=trim(path)//'input.profiles.geo',&
   55.                 status='old',&
   56.                 iostat=ierr)
   57.    
   58.            if (ierr /= 0) then
   59.               EXPRO_nfourier = -1
   60.               close(io)
   61.            else
   62.               read(io,*) EXPRO_nfourier
   63.               close(io)
   64.               open(unit=io,file=trim(path)//trim(runfile),status='replace')
   65.               write(io,'(a)') 'INFO: (EXPRO) input.profiles.geo found'
   66.               close(io)
   67.            endif
   68.    
   69.            !--------------------------------------------------------------
   70.    
   71.         endif
   72.    
   73.         allocate(EXPRO_rho(EXPRO_n_exp))
   74.         allocate(EXPRO_rmin(EXPRO_n_exp))
   75.         allocate(EXPRO_rmaj(EXPRO_n_exp))
   76.         allocate(EXPRO_q(EXPRO_n_exp))
   77.         allocate(EXPRO_kappa(EXPRO_n_exp))
   78.    
   79.         allocate(EXPRO_delta(EXPRO_n_exp))
   80.         allocate(EXPRO_te(EXPRO_n_exp))
   81.         allocate(EXPRO_ne(EXPRO_n_exp))
   82.         allocate(EXPRO_z_eff(EXPRO_n_exp))
   83.         allocate(EXPRO_w0(EXPRO_n_exp))
   84.    
   85.         allocate(EXPRO_flow_mom(EXPRO_n_exp))
   86.         allocate(EXPRO_pow_e(EXPRO_n_exp))
   87.         allocate(EXPRO_pow_i(EXPRO_n_exp))
   88.         allocate(EXPRO_pow_ei(EXPRO_n_exp))
   89.         allocate(EXPRO_zeta(EXPRO_n_exp))
   90.    
   91.         allocate(EXPRO_flow_beam(EXPRO_n_exp))
   92.         allocate(EXPRO_flow_wall(EXPRO_n_exp))
   93.         allocate(EXPRO_zmag(EXPRO_n_exp))
   94.         allocate(EXPRO_ptot(EXPRO_n_exp))
   95.         allocate(EXPRO_dlnptotdr(EXPRO_n_exp))
   96.    
   97.         allocate(EXPRO_ni(nion_max,EXPRO_n_exp))
   98.         allocate(EXPRO_ti(nion_max,EXPRO_n_exp))
   99.         allocate(EXPRO_vtor(nion_max,EXPRO_n_exp))
  100.         allocate(EXPRO_vpol(nion_max,EXPRO_n_exp))
  101.    
  102.         allocate(EXPRO_bunit(EXPRO_n_exp))
  103.         allocate(EXPRO_s(EXPRO_n_exp))
  104.         allocate(EXPRO_drmaj(EXPRO_n_exp))
  105.         allocate(EXPRO_dzmag(EXPRO_n_exp))
  106.         allocate(EXPRO_sdelta(EXPRO_n_exp))
  107.         allocate(EXPRO_skappa(EXPRO_n_exp))
  108.         allocate(EXPRO_szeta(EXPRO_n_exp))
  109.         allocate(EXPRO_dlnnedr(EXPRO_n_exp))
  110.         allocate(EXPRO_dlntedr(EXPRO_n_exp))
  111.    
  112.         allocate(EXPRO_dlnnidr(nion_max,EXPRO_n_exp))
  113.         allocate(EXPRO_dlntidr(nion_max,EXPRO_n_exp))
  114.    
  115.         allocate(EXPRO_vol(EXPRO_n_exp))
  116.         allocate(EXPRO_volp(EXPRO_n_exp))
  117.    
  118.         allocate(EXPRO_cs(EXPRO_n_exp))
  119.         allocate(EXPRO_rhos(EXPRO_n_exp))
  120.    
  121.         allocate(EXPRO_w0p(EXPRO_n_exp))
  122.         allocate(EXPRO_gamma_e(EXPRO_n_exp))
  123.         allocate(EXPRO_gamma_p(EXPRO_n_exp))
  124.         allocate(EXPRO_mach(EXPRO_n_exp))
  125.    
  126.         allocate(EXPRO_energy_c(nion_max,EXPRO_n_exp))
  127.    
  128.         if (EXPRO_nfourier > 0) then  
  129.            allocate(EXPRO_geo(4,0:EXPRO_nfourier,EXPRO_n_exp))
  130.            allocate(EXPRO_dgeo(4,0:EXPRO_nfourier,EXPRO_n_exp))
  131.         endif
  132.    
  133.         allocate(EXPRO_ni_new(EXPRO_n_exp))
  134.         allocate(EXPRO_dlnnidr_new(EXPRO_n_exp))
  135.         allocate(EXPRO_grad_r0(EXPRO_n_exp))
  136.         allocate(EXPRO_ave_grad_r(EXPRO_n_exp))
  137.         allocate(EXPRO_drdrho(EXPRO_n_exp))
  138.         allocate(EXPRO_bp0(EXPRO_n_exp))
  139.         allocate(EXPRO_bt0(EXPRO_n_exp))
  140.         allocate(EXPRO_poloidalfluxover2pi(EXPRO_n_exp))
  141.    
  142.      else
  143.    
  144.         deallocate(EXPRO_rho)
  145.         deallocate(EXPRO_rmin)
  146.         deallocate(EXPRO_rmaj)
  147.         deallocate(EXPRO_q)
  148.         deallocate(EXPRO_kappa)
  149.    
  150.         deallocate(EXPRO_delta)
  151.         deallocate(EXPRO_te)
  152.         deallocate(EXPRO_ne)
  153.         deallocate(EXPRO_z_eff)
  154.         deallocate(EXPRO_w0)
  155.    
  156.         deallocate(EXPRO_flow_mom)
  157.         deallocate(EXPRO_pow_e)
  158.         deallocate(EXPRO_pow_i)
  159.         deallocate(EXPRO_pow_ei)
  160.         deallocate(EXPRO_zeta)
  161.    
  162.         deallocate(EXPRO_flow_beam)
  163.         deallocate(EXPRO_flow_wall)
  164.         deallocate(EXPRO_zmag)
  165.         deallocate(EXPRO_ptot)
  166.         deallocate(EXPRO_poloidalfluxover2pi)
  167.    
  168.         deallocate(EXPRO_ni)
  169.         deallocate(EXPRO_ti)
  170.         deallocate(EXPRO_vtor)
  171.         deallocate(EXPRO_vpol)
  172.    
  173.         deallocate(EXPRO_bunit)
  174.         deallocate(EXPRO_s)
  175.         deallocate(EXPRO_drmaj)
  176.         deallocate(EXPRO_dzmag)
  177.         deallocate(EXPRO_sdelta)
  178.         deallocate(EXPRO_skappa)
  179.         deallocate(EXPRO_szeta)
  180.         deallocate(EXPRO_dlnnedr)
  181.         deallocate(EXPRO_dlntedr)
  182.    
  183.         deallocate(EXPRO_dlnnidr)
  184.         deallocate(EXPRO_dlntidr)
  185.    
  186.         deallocate(EXPRO_vol)
  187.         deallocate(EXPRO_volp)
  188.    
  189.         deallocate(EXPRO_cs)
  190.         deallocate(EXPRO_rhos)
  191.    
  192.         deallocate(EXPRO_w0p)
  193.         deallocate(EXPRO_gamma_e)
  194.         deallocate(EXPRO_gamma_p)
  195.         deallocate(EXPRO_mach)
  196.    
  197.         if (allocated(EXPRO_geo)) deallocate(EXPRO_geo)
  198.         if (allocated(EXPRO_dgeo)) deallocate(EXPRO_dgeo)
  199.    
  200.         deallocate(EXPRO_ni_new)
  201.         deallocate(EXPRO_dlnnidr_new)
  202.         deallocate(EXPRO_grad_r0)
  203.         deallocate(EXPRO_ave_grad_r)
  204.         deallocate(EXPRO_drdrho)
  205.         deallocate(EXPRO_bp0)
  206.         deallocate(EXPRO_bt0)
  207.         deallocate(EXPRO_dlnptotdr)
  208.         deallocate(EXPRO_energy_c)
  209.    
  210.    
  211.      endif
  212.    
  213.    end subroutine EXPRO_alloc_control


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
ALLOCATED(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   EXPRO_ALLOC_CONTROL (Line 197, file EXPRO_alloc_control.f90)
                   EXPRO_ALLOC_CONTROL (Line 198, file EXPRO_alloc_control.f90)

Name  Messages
----  --------
EXPRO_ALLOC_CONTROL
      Defined as:  Subroutine (line 1, file EXPRO_alloc_control.f90)

      Interface:   None

      Calls:       TRIM(Intrinsic) (Line 27, file EXPRO_alloc_control.f90)
                   TRIM(Intrinsic) (Line 38, file EXPRO_alloc_control.f90)
                   TRIM(Intrinsic) (Line 38, file EXPRO_alloc_control.f90)
                   TRIM(Intrinsic) (Line 43, file EXPRO_alloc_control.f90)
                   TRIM(Intrinsic) (Line 43, file EXPRO_alloc_control.f90)
                   TRIM(Intrinsic) (Line 54, file EXPRO_alloc_control.f90)
                   TRIM(Intrinsic) (Line 64, file EXPRO_alloc_control.f90)
                   TRIM(Intrinsic) (Line 64, file EXPRO_alloc_control.f90)
                   ALLOCATED(Intrinsic) (Line 197, file EXPRO_alloc_control.f90)
                   ALLOCATED(Intrinsic) (Line 198, file EXPRO_alloc_control.f90)

        Uses:      EXPRO_GLOBALS
                   EXPRO_INTERFACE

Name  Messages
----  --------
EXPRO_GLOBALS
      Defined as:  No definitions.

      Used By:     EXPRO_ALLOC_CONTROL

Name  Messages
----  --------
EXPRO_INTERFACE
      Defined as:  No definitions.

      Used By:     EXPRO_ALLOC_CONTROL

Name  Messages
----  --------
TRIM(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   EXPRO_ALLOC_CONTROL (Line 27, file EXPRO_alloc_control.f90)
                   EXPRO_ALLOC_CONTROL (Line 38, file EXPRO_alloc_control.f90)
                   EXPRO_ALLOC_CONTROL (Line 38, file EXPRO_alloc_control.f90)
                   EXPRO_ALLOC_CONTROL (Line 43, file EXPRO_alloc_control.f90)
                   EXPRO_ALLOC_CONTROL (Line 43, file EXPRO_alloc_control.f90)
                   EXPRO_ALLOC_CONTROL (Line 54, file EXPRO_alloc_control.f90)
                   EXPRO_ALLOC_CONTROL (Line 64, file EXPRO_alloc_control.f90)
                   EXPRO_ALLOC_CONTROL (Line 64, file EXPRO_alloc_control.f90)

Name  Messages
----  --------
_ALLOCATED(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None

Name  Messages
----  --------
_F90_TRIM(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
