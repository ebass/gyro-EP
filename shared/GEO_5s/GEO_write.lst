%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gacode_waltz_NBI_edison/shared/GEO/GEO_write.f90
Compiled : 06/09/16  13:24:32
Compiler : Version 8.4.3
Ftnlx    : Version 8413 (libcif 84006)
Target   : x86-64
Command  : ftn_driver.exe -hcpu=ivybridge -hstatic -D__CRAYXC
           -D__CRAY_IVYBRIDGE -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries
           -em -J/global/homes/b/bassem/gacode_waltz_NBI_edison/modules
           -sreal64 -eD -Ktrap=fp -m1 -c
           -I/opt/cray/cce/8.4.3/craylibs/x86-64/include -I/usr/include -ef
           -I/opt/cray/fftw/3.3.4.6/sandybridge/include
           -I/opt/cray/libsci/13.3.0/CRAY/8.3/x86_64/include
           -I/opt/cray/mpt/7.3.1/gni/sma/include
           -I/opt/cray/mpt/7.3.1/gni/mpich-cray/8.3/include
           -I/opt/cray/netcdf/4.3.3.1/CRAY/8.3/include
           -I/opt/cray/hdf5/1.8.16/CRAY/8.3/include
           -I/opt/cray/rca/1.0.0-2.0502.57212.2.56.ari/include
           -I/opt/cray/alps/5.2.3-2.0502.9295.14.14.ari/include
           -I/opt/cray/xpmem/0.1-2.0502.57015.1.15.ari/include
           -I/opt/cray/gni-headers/4.0-1.0502.10317.9.2.ari/include
           -I/opt/cray/dmapp/7.0.1-1.0502.10246.8.47.ari/include
           -I/opt/cray/pmi/5.0.10-1.0000.11050.0.0.ari/include
           -I/opt/cray/ugni/6.0-1.0502.10245.9.9.ari/include
           -I/opt/cray/udreg/2.3.2-1.0502.9889.2.20.ari/include
           -I/opt/cray/cce/8.4.3/craylibs/x86-64/pkgconfig/../include
           -I/opt/cray/cce/8.4.3/craylibs/x86-64/pkgconfig/..//include
           -I/usr/local/include
           -I/opt/cray/wlm_detect/1.0-1.0502.57063.1.1.ari/include
           -I/opt/cray/krca/1.0.0-2.0502.57202.2.45.ari/include
           -I/opt/cray-hss-devel/7.2.0/include GEO_write.f90
Program
  Units  : GEO_WRITE

ftnlx report
------------
Source   : /global/u2/b/bassem/gacode_waltz_NBI_edison/shared/GEO/GEO_write.f90
Date     : 06/09/2016  13:24:32


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    subroutine GEO_write(datafile,io)
    2.    
    3.      use GEO_interface
    4.    
    5.      implicit none
    6.    
    7.      !-------------------------------------------------------
    8.      integer, intent(in) :: io
    9.      character (len=*), intent(in) :: datafile
   10.      !
   11.      integer :: i
   12.      integer :: n_theta
   13.      !
   14.      character (len=12), dimension(6) :: tag
   15.      real, parameter :: pi=3.141592653589793
   16.      !-------------------------------------------------------
   17.    
   18.      n_theta = size(GEOV_b)
   19.    
   20.      open(unit=io,file=datafile,status='replace')
   21.    
   22.      write(io,*) '----------------------------------------------------------------'
   23.      write(io,*) ' Sample output from GEO'
   24.      write(io,*) '----------------------------------------------------------------'
   25.      write(io,*)
   26.      write(io,'(a,i4)') 'n_theta = ',n_theta
   27.      write(io,*)
   28.      write(io,10) 'GEO_fluxsurfave_grad_r',GEO_fluxsurfave_grad_r
   29.      write(io,10) 'GEO_fluxsurfave_grad_r2',GEO_fluxsurfave_grad_r2
   30.      write(io,10) 'GEO_volume',GEO_volume
   31.      write(io,10) 'GEO_volume_prime',GEO_volume_prime
   32.      write(io,10) 'GEO_volume/circle_vol',GEO_volume/(2*pi**2*GEO_rmin_in**2*GEO_rmaj_in)
   33.      write(io,10) 'GEO_volume/circle_volp',GEO_volume_prime/(4*pi**2*GEO_rmin_in*GEO_rmaj_in)
   34.      write(io,10) 'ffprime',GEO_ffprime
   35.      write(io,10) 'f',GEO_f
   36.      write(io,10) 'f/R0',GEO_f/GEO_rmaj_in
   37.      write(io,10) 'beta_star (beta_unit*dlnpdr)',GEO_beta_star
   38.      write(io,*)
   39.    
   40.      tag(1) = 'theta'
   41.      tag(2) = 'b'
   42.      tag(3) = 'dbdt'
   43.      tag(4) = 'dbdt2'
   44.      tag(5) = 'g_theta'
   45.      tag(6) = 'grad_r'
   46.    
   47.      write(1,*)
   48.      write(io,30) tag(:)
   49.      write(1,*)
   50.    
   51.      do i=1,n_theta
   52.         write(1,20) GEOV_theta(i),GEOV_b(i),GEOV_dbdt(i),GEOV_dbdt2(i),&
   53.              GEOV_g_theta(i),GEOV_grad_r(i)
   54.      enddo
   55.    
   56.      tag(1) = 'theta'
   57.      tag(2) = 'gsin'
   58.      tag(3) = 'gcos1'
   59.      tag(4) = 'gcos2'
   60.      tag(5) = 'gq'
   61.      tag(6) = 'captheta'
   62.    
   63.      write(1,*)
   64.      write(1,*)  tag(:)
   65.      write(1,*)
   66.      do i=1,n_theta
   67.         write(1,20) GEOV_theta(i),GEOV_gsin(i),GEOV_gcos1(i),GEOV_gcos2(i),&
   68.              GEOV_gq(i),GEOV_captheta(i)
   69.      enddo
   70.    
   71.      tag(1) = 'theta'
   72.      tag(2) = 'theta_nc'
   73.      tag(3) = '(null)'
   74.      tag(4) = '(null)'
   75.      tag(5) = '(null)'
   76.      tag(6) = '(null)'
   77.    
   78.      write(1,*)
   79.      write(1,*)  tag(:)
   80.      write(1,*)
   81.      do i=1,n_theta
   82.         write(1,20) GEOV_theta(i),GEOV_theta_nc(i),0.0,0.0,0.0,0.0
   83.      enddo
   84.    
   85.      close(io)
   86.    
   87.    10 format(t2,a,': ',f10.6)
   88.    20 format(10(es11.4,1x))
   89.    30 format(t2,6(a))
   90.    
   91.    end subroutine GEO_write


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
GEO_INTERFACE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

Name  Messages
----  --------
GEO_WRITE
      Defined as:  Subroutine (line 1, file GEO_write.f90)

      Interface:   None

      Calls:       SIZE(Intrinsic) (Line 18, file GEO_write.f90)

Name  Messages
----  --------
SIZE(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   GEO_WRITE (Line 18, file GEO_write.f90)

Name  Messages
----  --------
__SIZE(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
