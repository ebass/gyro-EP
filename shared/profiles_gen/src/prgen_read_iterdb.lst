%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gyro-EP/shared/profiles_gen/src/prgen_read_iterdb.f90
Compiled : 01/19/21  15:35:00
Compiler : Version 9.1.0
Ftnlx    : Version 9.1.0 
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hdynamic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -hnoomp -em
           -J/global/homes/b/bassem/gyro-EP/modules -sreal64 -eD -Ktrap=fp -m1
           -Rbcdps -G0 -I/opt/cray/pe/netcdf/4.6.3.2/CRAYCLANG/9.0/include
           -c prgen_read_iterdb.f90
           -I/opt/cray/pe/cce/9.1.0/cce-clang/x86_64/lib/clang/9.0.0/include
           -I/opt/cray/pe/cce/9.1.0/cce/x86_64/include/craylibs -I/usr/include
           -I/usr/include -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -I/opt/cray/pe/libsci/19.06.1/CRAY/9.0/x86_64/include
           -I/opt/cray/pe/mpt/7.7.10/gni/mpich-cray/9.0/include
           -I/opt/cray/pe/hdf5/1.10.5.2/cray/9.0/include
           -I/opt/cray/pe/netcdf/4.6.3.2/cray/9.0/include
           -I/opt/cray/rca/2.2.20-7.0.1.1_4.53__g8e3fb5b.ari/include
           -I/opt/cray/alps/6.6.58-7.0.1.1_6.10__g437d88db.ari/include
           -I/opt/cray/xpmem/2.2.20-7.0.1.1_4.14__g0475745.ari/include
           -I/opt/cray/gni-headers/5.0.12.0-7.0.1.1_6.32__g3b1768f.ari/include
           -I/opt/cray/dmapp/7.1.1-7.0.1.1_4.54__g38cf134.ari/include
           -I/opt/cray/pe/pmi/5.0.14/include
           -I/opt/cray/ugni/6.0.14.0-7.0.1.1_7.40__ge78e5b0.ari/include
           -I/opt/cray/udreg/2.3.2-7.0.1.1_3.38__g8175d3d.ari/include
           -I/opt/cray/wlm_detect/1.3.3-7.0.1.1_4.16__g7109084.ari/include
           -I/opt/cray/krca/2.2.6-7.0.1.1_5.39__gb641b12.ari/include
           -I/opt/cray-hss-devel/9.0.0/include
Program
  Units  : PRGEN_READ_ITERDB

ftnlx report
------------
Source   : /global/u2/b/bassem/gyro-EP/shared/profiles_gen/src/prgen_read_iterdb.f90
Date     : 01/19/2021  15:35:00


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    !--------------------------------------------------------------
    2.    ! prgen_read_iterdb.f90
    3.    !
    4.    ! PURPOSE:
    5.    !  Extract iterdb data from native TEXT file.
    6.    !--------------------------------------------------------------
    7.    
    8.    subroutine prgen_read_iterdb
    9.    
   10.      use prgen_globals
   11.    
   12.      implicit none
   13.    
   14.      character (len=100) :: t
   15.      integer :: i
   16.      real :: x
   17.      real, dimension(:), allocatable :: xv
   18.      real, dimension(:), allocatable :: xvv
   19.    
   20.      !----------------------------------------------------
   21.      ! Read the iterdb file
   22.      !
   23.      open(unit=1,file=raw_data_file,status='old')
   24.      read(1,*) t
   25.    
   26.      read(1,*) t ; read(1,*) onetwo_ishot
   27.      read(1,*) t ; read(1,*) nx
   28.      read(1,*) t ; read(1,*) onetwo_nion
   29.      read(1,*) t ; read(1,*) onetwo_nprim
   30.      read(1,*) t ; read(1,*) onetwo_nimp
   31.      read(1,*) t ; read(1,*) onetwo_nneu
   32.      read(1,*) t ; read(1,*) i
   33.      read(1,*) t ; read(1,*) onetwo_namep(1:onetwo_nprim)
   34.      read(1,*) t ; read(1,*) onetwo_namei(1:onetwo_nimp)
   35.      onetwo_nameb(1) = onetwo_namep(i)
   36.      onetwo_nbion = 1 ! Assume 1 for now
   37.      read(1,*) t ; read(1,*) t
   38.      read(1,*) t ; read(1,*) onetwo_time
   39.      read(1,*) t ; read(1,*) onetwo_Rgeom
   40.      read(1,*) t ; read(1,*) onetwo_Rmag
   41.      read(1,*) t ; read(1,*) onetwo_R0
   42.      read(1,*) t ; read(1,*) onetwo_kappa
   43.      read(1,*) t ; read(1,*) onetwo_delta
   44.      read(1,*) t ; read(1,*) x
   45.      read(1,*) t ; read(1,*) onetwo_volo
   46.      read(1,*) t ; read(1,*) onetwo_cxareao
   47.      read(1,*) t ; read(1,*) onetwo_Btor
   48.      read(1,*) t ; read(1,*) ip_tot
   49.      read(1,*) t ; read(1,*) x
   50.      read(1,*) t ; read(1,*) x
   51.      read(1,*) t ; read(1,*) x
   52.      read(1,*) t ; read(1,*) x ! Te0
   53.      read(1,*) t ; read(1,*) x ! Ti0
   54.    
   55.      call allocate_internals
   56.      call allocate_iterdb_vars
   57.    
   58.      allocate(xv(nx))
   59.    
   60.      read(1,*) t ; read(1,*) onetwo_psi ! psi on rho grid
   61.      read(1,*) t ; read(1,*) onetwo_rho_grid
   62.      read(1,*) t ; read(1,*) xv ! fcap
   63.      read(1,*) t ; read(1,*) xv ! gcap
   64.      read(1,*) t ; read(1,*) onetwo_hcap
   65.      read(1,*) t ; read(1,*) onetwo_te
   66.      read(1,*) t ; read(1,*) onetwo_ti
   67.      read(1,*) t ; read(1,*) q
   68.      read(1,*) t ; read(1,*) onetwo_ene
   69.    
   70.    
   71.      do i=1,onetwo_nion
   72.         read(1,*) t ; read(1,*) onetwo_enion(:,i)
   73.      enddo
   74.    
   75.    
   76.      sbcx_d(:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 76 
  A loop starting at line 76 was not vectorized because it contains a reference to a non-vector intrinsic on line 76.

   77.      sion_d(:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 77 
  A loop starting at line 77 was not vectorized because it contains a reference to a non-vector intrinsic on line 77.

   78.      do i=1,onetwo_nprim
   79.         read(1,*) t ; read(1,*) onetwo_sion(:,i)
   80.         read(1,*) t ; read(1,*) onetwo_srecom(:,i)
   81.         read(1,*) t ; read(1,*) onetwo_scx(:,i)
   82.         read(1,*) t ; read(1,*) onetwo_sbcx(:,i)
   83.         read(1,*) t ; read(1,*) onetwo_s(:,i)
   84.         read(1,*) t ; read(1,*) onetwo_dudt(:,i)
   85.         sbcx_d(:) = sbcx_d(:)+onetwo_sbcx(:,i)
ftn-6262 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 85 
  A loop starting at line 85 was not vectorized because it contains a call to a subroutine or function on line 85.

   86.         sion_d(:) = sion_d(:)+onetwo_sion(:,i)
ftn-6262 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 86 
  A loop starting at line 86 was not vectorized because it contains a call to a subroutine or function on line 86.

   87.      enddo
   88.    
   89.      read(1,*) t ; read(1,*) onetwo_enbeam(:,1) ! fast ion density
   90.    
   91.      do i=1,onetwo_nprim
   92.         read(1,*) t ; read(1,*) xv ! neutral density
   93.      enddo
   94.    
   95.      do i=1,onetwo_nprim
   96.         read(1,*) t ; read(1,*) xv ! neutral density from wall source
   97.      enddo
   98.    
   99.      do i=1,onetwo_nprim
  100.         read(1,*) t ; read(1,*) xv ! neutral density from volume source
  101.      enddo
  102.    
  103.      do i=1,onetwo_nprim
  104.         read(1,*) t ; read(1,*) xv ! volume source of neutrals
  105.      enddo
  106.    
  107.      read(1,*) t ; read(1,*) onetwo_sbeame ! (sbion) beam electron source
  108.      read(1,*) t ; read(1,*) onetwo_sbeam  ! (sbion) beam thermal ion source
  109.      read(1,*) t ; read(1,*) xv ! total current density
  110.      read(1,*) t ; read(1,*) xv ! ohmic current density
  111.      read(1,*) t ; read(1,*) xv ! bootstrap current density
  112.      read(1,*) t ; read(1,*) xv ! beam-driven current density
  113.      read(1,*) t ; read(1,*) xv ! RF current density
  114.      read(1,*) t ; read(1,*) xv ! rho*bp0*fcap*gcap*hcap, tesla*meters
  115.      read(1,*) t ; read(1,*) onetwo_zeff   ! 31
  116.      read(1,*) t ; read(1,*) onetwo_angrot ! 32
  117.      read(1,*) t ; read(1,*) xv ! electron thermal diffusivity
  118.      read(1,*) t ; read(1,*) xv ! ion thermal diffusivity
  119.      read(1,*) t ; read(1,*) xv ! ion nc thermal diffusivity
  120.      read(1,*) t ; read(1,*) onetwo_dpedt ! 36
  121.      read(1,*) t ; read(1,*) onetwo_dpidt ! 37
  122.      read(1,*) t ; read(1,*) xv ! electron conduction
  123.      read(1,*) t ; read(1,*) xv ! ion conduction
  124.      read(1,*) t ; read(1,*) xv ! electron convection
  125.      read(1,*) t ; read(1,*) xv ! ion convection
  126.      read(1,*) t ; read(1,*) onetwo_qbeame  ! 42
  127.      read(1,*) t ; read(1,*) onetwo_qdelt   ! 43
  128.      read(1,*) t ; read(1,*) onetwo_qbeami  ! 44
  129.      read(1,*) t ; read(1,*) onetwo_qrfe    ! 45
  130.      read(1,*) t ; read(1,*) onetwo_qrfi    ! 46
  131.      read(1,*) t ; read(1,*) onetwo_qione   ! 47
  132.      read(1,*) t ; read(1,*) onetwo_qioni   ! 48
  133.      read(1,*) t ; read(1,*) onetwo_qcx     ! 49
  134.      read(1,*) t ; read(1,*) xv ! 2d electron heating
  135.      read(1,*) t ; read(1,*) xv ! 2d ion heating
  136.      read(1,*) t ; read(1,*) onetwo_qfuse  ! 52
  137.      read(1,*) t ; read(1,*) onetwo_qfusi  ! 53
  138.      read(1,*) t ; read(1,*) xv ! beam fusion electron heating
  139.      read(1,*) t ; read(1,*) xv ! beam fusion ion heating
  140.      read(1,*) t ; read(1,*) xv ! qmag electron heating
  141.      read(1,*) t ; read(1,*) xv ! sawtooth electron heating
  142.      read(1,*) t ; read(1,*) xv ! sawtooth ion heating
  143.      read(1,*) t ; read(1,*) onetwo_qrad ! 59
  144.      read(1,*) t ; read(1,*) onetwo_qohm ! 60
  145.      read(1,*) t ; read(1,*) rmaj ! 61
  146.      read(1,*) t ; read(1,*) rmin ! 62
  147.      read(1,*) t ; read(1,*) onetwo_volume ! 63
  148.      read(1,*) t ; read(1,*) kappa ! 64
  149.      read(1,*) t ; read(1,*) delta ! 65
  150.      read(1,*) t ; read(1,*) xv ! indentation of each flux surface
  151.      read(1,*) t
  152.      read(1,*) t ; read(1,*) xv ! surface area each flux surface
  153.      read(1,*) t ; read(1,*) xv ! cross-sectional area each surface
  154.      read(1,*) t ; read(1,*) xv ! flux surface average absolute grad rho
  155.      read(1,*) t ; read(1,*) xv ! flux surface grad_rho_sq
  156.      read(1,*) t ; read(1,*) onetwo_nb ! number points in plasma boundary
  157.    
  158.      allocate(xvv(onetwo_nb))
  159.    
  160.      read(1,*) t ; read(1,*) xvv !plasma boundary r
  161.      read(1,*) t ; read(1,*) xvv !plasma boundary z
  162.    
  163.      ! Torque density may be missing in iterdb file
  164.      read(1,'(a)',iostat=i) t
  165.      if (i == 0) then
  166.         print '(3(a))', 'INFO: (prgen) Assuming "', trim(t), '" is beam torque density.'
  167.         read(1,*) onetwo_storqueb !torque density nt-m/m**3
  168.      else
  169.         onetwo_storqueb(:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 169 
  A loop starting at line 169 was not vectorized because it contains a reference to a non-vector intrinsic on line 169.

  170.      endif
  171.    
  172.      ! Beam pressure may be missing in iterdb file
  173.      read(1,'(a)',iostat=i) t
  174.      if (i == 0) then
  175.         print '(3(a))', 'INFO: (prgen) Assuming "', trim(t), '" is beam pressure.'
  176.         read(1,*) onetwo_pressb(:,1)
  177.      else
  178.         onetwo_pressb(:,:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 178 
  A loop starting at line 178 was not vectorized because it contains a reference to a non-vector intrinsic on line 178.

  179.         onetwo_nbion = 0 ! Need beam pressure to get effective beam temp
  180.      endif
  181.    
  182.      ! Total pressure may be missing in iterdb file
  183.      read(1,'(a)',iostat=i) t
  184.      if (i == 0) then
  185.         print '(3(a))', 'INFO: (prgen) Assuming "', trim(t), '" is total pressure.'
  186.        read(1,*) p_tot(:)
  187.      else
  188.        p_tot(:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 188 
  A loop starting at line 188 was not vectorized because it contains a reference to a non-vector intrinsic on line 188.

  189.      endif
  190.    
  191.      ! sscxl may be missing in iterdb file
  192.      read(1,'(a)',iostat=i) t
  193.      if (i == 0) then
  194.         print '(3(a))', 'INFO: (prgen) Found new quantity "', trim(t), '" in iterdb file.'
  195.        read(1,*) onetwo_sscxl(:)
  196.      else
  197.        onetwo_sscxl(:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 197 
  A loop starting at line 197 was not vectorized because it contains a reference to a non-vector intrinsic on line 197.

  198.      endif
  199.    
  200.    
  201.      
  202.      dpsi(:) = onetwo_psi(:)-onetwo_psi(1)
ftn-6262 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 202 
  A loop starting at line 202 was not vectorized because it contains a call to a subroutine or function on line 202.

  203.    
  204.      ! No squareness
  205.      zeta(:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 205 
  A loop starting at line 205 was not vectorized because it contains a reference to a non-vector intrinsic on line 205.

  206.    
  207.      ! No elevation
  208.      zmag(:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_READ_ITERDB, File = prgen_read_iterdb.f90, Line = 208 
  A loop starting at line 208 was not vectorized because it contains a reference to a non-vector intrinsic on line 208.

  209.    
  210.    end subroutine prgen_read_iterdb


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
ALLOCATE_INTERNALS
      Defined as:  No definitions.

      Interface:   None

      Called By:   PRGEN_READ_ITERDB (Line 55, file prgen_read_iterdb.f90)

Name  Messages
----  --------
ALLOCATE_ITERDB_VARS
      Defined as:  No definitions.

      Interface:   None

      Called By:   PRGEN_READ_ITERDB (Line 56, file prgen_read_iterdb.f90)

Name  Messages
----  --------
PRGEN_GLOBALS
      Defined as:  No definitions.

      Used By:     PRGEN_READ_ITERDB

Name  Messages
----  --------
PRGEN_READ_ITERDB
      Defined as:  Subroutine (line 8, file prgen_read_iterdb.f90)

      Interface:   None

      Calls:       ALLOCATE_INTERNALS (Line 55, file prgen_read_iterdb.f90)
                   ALLOCATE_ITERDB_VARS (Line 56, file prgen_read_iterdb.f90)
                   TRIM(Intrinsic) (Line 166, file prgen_read_iterdb.f90)
                   TRIM(Intrinsic) (Line 175, file prgen_read_iterdb.f90)
                   TRIM(Intrinsic) (Line 185, file prgen_read_iterdb.f90)
                   TRIM(Intrinsic) (Line 194, file prgen_read_iterdb.f90)

        Uses:      PRGEN_GLOBALS

Name  Messages
----  --------
TRIM(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   PRGEN_READ_ITERDB (Line 166, file prgen_read_iterdb.f90)
                   PRGEN_READ_ITERDB (Line 175, file prgen_read_iterdb.f90)
                   PRGEN_READ_ITERDB (Line 185, file prgen_read_iterdb.f90)
                   PRGEN_READ_ITERDB (Line 194, file prgen_read_iterdb.f90)

Name  Messages
----  --------
_F90_TRIM(Intrinsic)
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
