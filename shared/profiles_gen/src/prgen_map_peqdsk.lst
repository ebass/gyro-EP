%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gyro-EP/shared/profiles_gen/src/prgen_map_peqdsk.f90
Compiled : 01/19/21  15:34:57
Compiler : Version 9.1.0
Ftnlx    : Version 9.1.0 
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hdynamic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -hnoomp -em
           -J/global/homes/b/bassem/gyro-EP/modules -sreal64 -eD -Ktrap=fp -m1
           -Rbcdps -G0 -I/opt/cray/pe/netcdf/4.6.3.2/CRAYCLANG/9.0/include
           -c prgen_map_peqdsk.f90
           -I/opt/cray/pe/cce/9.1.0/cce-clang/x86_64/lib/clang/9.0.0/include
           -I/opt/cray/pe/cce/9.1.0/cce/x86_64/include/craylibs -I/usr/include
           -I/usr/include -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -I/opt/cray/pe/libsci/19.06.1/CRAY/9.0/x86_64/include
           -I/opt/cray/pe/mpt/7.7.10/gni/mpich-cray/9.0/include
           -I/opt/cray/pe/hdf5/1.10.5.2/cray/9.0/include
           -I/opt/cray/pe/netcdf/4.6.3.2/cray/9.0/include
           -I/opt/cray/rca/2.2.20-7.0.1.1_4.53__g8e3fb5b.ari/include
           -I/opt/cray/alps/6.6.58-7.0.1.1_6.10__g437d88db.ari/include
           -I/opt/cray/xpmem/2.2.20-7.0.1.1_4.14__g0475745.ari/include
           -I/opt/cray/gni-headers/5.0.12.0-7.0.1.1_6.32__g3b1768f.ari/include
           -I/opt/cray/dmapp/7.1.1-7.0.1.1_4.54__g38cf134.ari/include
           -I/opt/cray/pe/pmi/5.0.14/include
           -I/opt/cray/ugni/6.0.14.0-7.0.1.1_7.40__ge78e5b0.ari/include
           -I/opt/cray/udreg/2.3.2-7.0.1.1_3.38__g8175d3d.ari/include
           -I/opt/cray/wlm_detect/1.3.3-7.0.1.1_4.16__g7109084.ari/include
           -I/opt/cray/krca/2.2.6-7.0.1.1_5.39__gb641b12.ari/include
           -I/opt/cray-hss-devel/9.0.0/include
Program
  Units  : PRGEN_MAP_PEQDSK

ftnlx report
------------
Source   : /global/u2/b/bassem/gyro-EP/shared/profiles_gen/src/prgen_map_peqdsk.f90
Date     : 01/19/2021  15:34:57


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    !------------------------------------------------------------
    2.    ! prgen_map_peqdsk.f90
    3.    !
    4.    ! PURPOSE:
    5.    !  Map native peqdsk data onto input.profiles standard.  
    6.    !------------------------------------------------------------
    7.    
    8.    subroutine prgen_map_peqdsk
    9.    
   10.      use prgen_globals
   11.      use EXPRO_interface
   12.      
   13.      implicit none
   14.      
   15.      integer :: i
   16.      real, dimension(nx) :: ni_d
   17.      real, dimension(3,nx) :: ni_imp
   18.      real, dimension(nx) :: ni_b
   19.      real, dimension(nx) :: z_eff
   20.    
   21.      ! Compute rho, bref and arho:
   22.      call prgen_get_chi(nx,q,kappa,rmin,dpsi,rho,peqdsk_bref,peqdsk_arho)
   23.    
   24.      ni_d(:) = 10*peqdsk_ni(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 24 
  A loop starting at line 24 was not vectorized because it contains a call to a subroutine or function on line 24.

   25.      if(peqdsk_fmt == 0) then
   26.         ! old p-file, assume missing density is carbon
   27.         ni_imp(1,:) = 10*(peqdsk_ne(:)-peqdsk_ni(:)-peqdsk_nb(:))/6.0
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 27 
  A loop starting at line 27 was not vectorized because it contains a call to a subroutine or function on line 27.

   28.         peqdsk_nimp  = 1
   29.         peqdsk_z(1)  = 1.0
   30.         peqdsk_m(1)  = 2.0
   31.         peqdsk_z(2)  = 6.0
   32.         peqdsk_m(2)  = 12.0
   33.         if(peqdsk_nbeams == 1) then
   34.            peqdsk_z(3)  = 1.0
   35.            peqdsk_m(3)  = 2.0
   36.         endif
   37.      else
   38.         ! new p-file
   39.         do i=1,peqdsk_nimp
   40.            ni_imp(i,:) = 10*peqdsk_nz(i,:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 40 
  A loop starting at line 40 was not vectorized because it contains a call to a subroutine or function on line 40.

   41.         enddo
   42.      endif
   43.      ni_b(:) = 10*peqdsk_nb(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 43 
  A loop starting at line 43 was not vectorized because it contains a call to a subroutine or function on line 43.

   44.    
   45.      ! Compute Z_eff
   46.      z_eff(:) = peqdsk_z(1)**2 * ni_d(:)
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 46 
  A loop starting at line 46 was not vectorized because it contains a reference to a non-vector intrinsic on line 46.

   47.      do i=1,peqdsk_nimp
   48.         z_eff(:) = z_eff(:)+peqdsk_z(1+i)**2 * ni_imp(i,:)
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 48 
  A loop starting at line 48 was not vectorized because it contains a reference to a non-vector intrinsic on line 48.

   49.      enddo
   50.      z_eff(:) = z_eff(:)+peqdsk_z(1+peqdsk_nimp+1)**2 * ni_b(:)
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 50 
  A loop starting at line 50 was not vectorized because it contains a reference to a non-vector intrinsic on line 50.

   51.      z_eff(:) = z_eff(:)/(10*peqdsk_ne(:))
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 51 
  A loop starting at line 51 was not vectorized because it contains a call to a subroutine or function on line 51.

   52.    
   53.      !---------------------------------------------------------
   54.      ! Map profile data onto single array:
   55.      !
   56.      EXPRO_n_exp = nx
   57.      call EXPRO_alloc('./',1)
   58.      !
   59.      EXPRO_rho(:)  = rho(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 59 
  A loop starting at line 59 was not vectorized because it contains a call to a subroutine or function on line 59.

   60.      EXPRO_rmin(:) = rmin(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 60 
  A loop starting at line 60 was not vectorized because it contains a call to a subroutine or function on line 60.

   61.      EXPRO_rmaj(:)  = rmaj(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 61 
  A loop starting at line 61 was not vectorized because it contains a call to a subroutine or function on line 61.

   62.      ! COORDINATES: set sign of q
   63.      EXPRO_q(:)      = abs(q(:))*ipccw*btccw
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 63 
  A loop starting at line 63 was not vectorized because it contains a call to a subroutine or function on line 63.

   64.      EXPRO_kappa(:)  = kappa(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 64 
  A loop starting at line 64 was not vectorized because it contains a call to a subroutine or function on line 64.

   65.      EXPRO_delta(:)  = delta(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 65 
  A loop starting at line 65 was not vectorized because it contains a call to a subroutine or function on line 65.

   66.      EXPRO_te(:)     = peqdsk_te(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 66 
  A loop starting at line 66 was not vectorized because it contains a call to a subroutine or function on line 66.

   67.      EXPRO_ne(:)     = peqdsk_ne(:)*10
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 67 
  A loop starting at line 67 was not vectorized because it contains a call to a subroutine or function on line 67.

   68.      EXPRO_z_eff(:)  = z_eff(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 68 
  A loop starting at line 68 was not vectorized because it contains a call to a subroutine or function on line 68.

   69.      ! COORDINATES: -ipccw accounts for DIII-D toroidal angle convention
   70.      EXPRO_w0(:)        = -ipccw*1e3*peqdsk_omgeb(:) 
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 70 
  A loop starting at line 70 was not vectorized because it contains a call to a subroutine or function on line 70.

   71.      EXPRO_flow_mom(:)  = 0.0      ! flow_mom
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 71 
  A loop starting at line 71 was not vectorized because it contains a reference to a non-vector intrinsic on line 71.

   72.      EXPRO_pow_e(:)     = 0.0      ! pow_e
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 72 
  A loop starting at line 72 was not vectorized because it contains a reference to a non-vector intrinsic on line 72.

   73.      EXPRO_pow_i(:)     = 0.0      ! pow_i 
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 73 
  A loop starting at line 73 was not vectorized because it contains a reference to a non-vector intrinsic on line 73.

   74.      EXPRO_pow_ei(:)    = 0.0      ! pow_ei_exp
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 74 
  A loop starting at line 74 was not vectorized because it contains a reference to a non-vector intrinsic on line 74.

   75.      EXPRO_zeta(:)      = zeta(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 75 
  A loop starting at line 75 was not vectorized because it contains a call to a subroutine or function on line 75.

   76.      EXPRO_flow_beam(:) = 0.0      ! flow_beam
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 76 
  A loop starting at line 76 was not vectorized because it contains a reference to a non-vector intrinsic on line 76.

   77.      EXPRO_flow_wall(:) = 0.0      ! flow_wall_exp
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 77 
  A loop starting at line 77 was not vectorized because it contains a reference to a non-vector intrinsic on line 77.

   78.      EXPRO_zmag(:)      = zmag(:)  
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 78 
  A loop starting at line 78 was not vectorized because it contains a call to a subroutine or function on line 78.

   79.      EXPRO_ptot(:)      = p_tot(:)      
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 79 
  A loop starting at line 79 was not vectorized because it contains a call to a subroutine or function on line 79.

   80.      ! COORDINATES: set sign of poloidal flux
   81.      EXPRO_polflux = abs(dpsi(:))*(-ipccw)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 81 
  A loop starting at line 81 was not vectorized because it contains a call to a subroutine or function on line 81.

   82.    
   83.      ! ni, nc, nb
   84.      EXPRO_ni(1,:) = ni_d(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 84 
  A loop starting at line 84 was not vectorized because it contains a call to a subroutine or function on line 84.

   85.      do i=1,peqdsk_nimp
   86.         EXPRO_ni(1+i,:) = ni_imp(i,:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 86 
  A loop starting at line 86 was not vectorized because it contains a call to a subroutine or function on line 86.

   87.      enddo
   88.      EXPRO_ni(1+peqdsk_nimp+1,:) = ni_b(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 88 
  A loop starting at line 88 was not vectorized because it contains a call to a subroutine or function on line 88.

   89.    
   90.      ! ti, tc, tb
   91.      EXPRO_ti(1,:) = peqdsk_ti(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 91 
  A loop starting at line 91 was not vectorized because it contains a call to a subroutine or function on line 91.

   92.      do i=1,peqdsk_nimp
   93.         EXPRO_ti(1+i,:) = peqdsk_ti(:)
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 93 
  A loop starting at line 93 was not vectorized because it contains a call to a subroutine or function on line 93.

   94.      enddo
   95.      do i=1,nx
   96.         if (peqdsk_nb(i) > epsilon(0.)) then
   97.            EXPRO_ti(1+peqdsk_nimp+1,i) = peqdsk_pb(i)/(peqdsk_nb(i)*10)/1.602
   98.         else
   99.            EXPRO_ti(1+peqdsk_nimp+1,i) = 0.0
  100.         endif
  101.      enddo
  102.    
  103.      ! vphi
  104.      ! COORDINATES: -ipccw accounts for DIII-D toroidal angle convention
  105.      EXPRO_vtor(:,:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 105 
  A loop starting at line 105 was not vectorized because it contains a reference to a non-vector intrinsic on line 105.

  106.      EXPRO_vtor(2,:) = -ipccw*1e3*peqdsk_omegat(:)*(rmaj(:)+rmin(:))
ftn-6262 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 106 
  A loop starting at line 106 was not vectorized because it contains a call to a subroutine or function on line 106.

  107.    
  108.      ! vpol
  109.      EXPRO_vpol(:,:) = 0.0
ftn-6263 ftn: VECTOR PRGEN_MAP_PEQDSK, File = prgen_map_peqdsk.f90, Line = 109 
  A loop starting at line 109 was not vectorized because it contains a reference to a non-vector intrinsic on line 109.

  110.    
  111.    end subroutine prgen_map_peqdsk


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
ABS(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   PRGEN_MAP_PEQDSK (Line 63, file prgen_map_peqdsk.f90)
                   PRGEN_MAP_PEQDSK (Line 81, file prgen_map_peqdsk.f90)

Name  Messages
----  --------
EPSILON(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   PRGEN_MAP_PEQDSK (Line 96, file prgen_map_peqdsk.f90)

Name  Messages
----  --------
EXPRO_ALLOC
      Defined as:  No definitions.

      Interface:   None

      Called By:   PRGEN_MAP_PEQDSK (Line 57, file prgen_map_peqdsk.f90)

Name  Messages
----  --------
EXPRO_INTERFACE
      Defined as:  No definitions.

      Used By:     PRGEN_MAP_PEQDSK

Name  Messages
----  --------
PRGEN_GET_CHI
      Defined as:  No definitions.

      Interface:   None

      Called By:   PRGEN_MAP_PEQDSK (Line 22, file prgen_map_peqdsk.f90)

Name  Messages
----  --------
PRGEN_GLOBALS
      Defined as:  No definitions.

      Used By:     PRGEN_MAP_PEQDSK

Name  Messages
----  --------
PRGEN_MAP_PEQDSK
      Defined as:  Subroutine (line 8, file prgen_map_peqdsk.f90)

      Interface:   None

      Calls:       PRGEN_GET_CHI (Line 22, file prgen_map_peqdsk.f90)
                   EXPRO_ALLOC (Line 57, file prgen_map_peqdsk.f90)
                   ABS(Intrinsic) (Line 63, file prgen_map_peqdsk.f90)
                   ABS(Intrinsic) (Line 81, file prgen_map_peqdsk.f90)
                   EPSILON(Intrinsic) (Line 96, file prgen_map_peqdsk.f90)

        Uses:      PRGEN_GLOBALS
                   EXPRO_INTERFACE


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
