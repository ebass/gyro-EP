%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gyro-EP/shared/math/gamma.f
Compiled : 01/19/21  14:38:38
Compiler : Version 9.1.0
Ftnlx    : Version 9.1.0 
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hdynamic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -hnoomp -em
           -J/global/homes/b/bassem/gyro-EP/modules -eD -Ktrap=fp -m1 -Rbcdps
           -c gamma.f
           -I/opt/cray/pe/cce/9.1.0/cce-clang/x86_64/lib/clang/9.0.0/include
           -I/opt/cray/pe/cce/9.1.0/cce/x86_64/include/craylibs -I/usr/include
           -I/usr/include -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -I/opt/cray/pe/libsci/19.06.1/CRAY/9.0/x86_64/include
           -I/opt/cray/pe/mpt/7.7.10/gni/mpich-cray/9.0/include
           -I/opt/cray/pe/hdf5/1.10.5.2/cray/9.0/include
           -I/opt/cray/pe/netcdf/4.6.3.2/cray/9.0/include
           -I/opt/cray/rca/2.2.20-7.0.1.1_4.53__g8e3fb5b.ari/include
           -I/opt/cray/alps/6.6.58-7.0.1.1_6.10__g437d88db.ari/include
           -I/opt/cray/xpmem/2.2.20-7.0.1.1_4.14__g0475745.ari/include
           -I/opt/cray/gni-headers/5.0.12.0-7.0.1.1_6.32__g3b1768f.ari/include
           -I/opt/cray/dmapp/7.1.1-7.0.1.1_4.54__g38cf134.ari/include
           -I/opt/cray/pe/pmi/5.0.14/include
           -I/opt/cray/ugni/6.0.14.0-7.0.1.1_7.40__ge78e5b0.ari/include
           -I/opt/cray/udreg/2.3.2-7.0.1.1_3.38__g8175d3d.ari/include
           -I/opt/cray/wlm_detect/1.3.3-7.0.1.1_4.16__g7109084.ari/include
           -I/opt/cray/krca/2.2.6-7.0.1.1_5.39__gb641b12.ari/include
           -I/opt/cray-hss-devel/9.0.0/include
Program
  Units  : DGAMMA

ftnlx report
------------
Source   : /global/u2/b/bassem/gyro-EP/shared/math/gamma.f
Date     : 01/19/2021  14:38:38


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    CS    REAL FUNCTION GAMMA(X)
    2.          DOUBLE PRECISION FUNCTION DGAMMA(X)
    3.    C----------------------------------------------------------------------
    4.    C
    5.    C This routine calculates the GAMMA function for a real argument X.
    6.    C   Computation is based on an algorithm outlined in reference 1.
    7.    C   The program uses rational functions that approximate the GAMMA
    8.    C   function to at least 20 significant decimal digits.  Coefficients
    9.    C   for the approximation over the interval (1,2) are unpublished.
   10.    C   Those for the approximation for X .GE. 12 are from reference 2.
   11.    C   The accuracy achieved depends on the arithmetic system, the
   12.    C   compiler, the intrinsic functions, and proper selection of the
   13.    C   machine-dependent constants.
   14.    C
   15.    C
   16.    C*******************************************************************
   17.    C*******************************************************************
   18.    C
   19.    C Explanation of machine-dependent constants
   20.    C
   21.    C beta   - radix for the floating-point representation
   22.    C maxexp - the smallest positive power of beta that overflows
   23.    C XBIG   - the largest argument for which GAMMA(X) is representable
   24.    C          in the machine, i.e., the solution to the equation
   25.    C                  GAMMA(XBIG) = beta**maxexp
   26.    C XINF   - the largest machine representable floating-point number;
   27.    C          approximately beta**maxexp
   28.    C EPS    - the smallest positive floating-point number such that
   29.    C          1.0+EPS .GT. 1.0
   30.    C XMININ - the smallest positive floating-point number such that
   31.    C          1/XMININ is machine representable
   32.    C
   33.    C     Approximate values for some important machines are:
   34.    C
   35.    C                            beta       maxexp        XBIG
   36.    C
   37.    C CRAY-1         (S.P.)        2         8191        966.961
   38.    C Cyber 180/855
   39.    C   under NOS    (S.P.)        2         1070        177.803
   40.    C IEEE (IBM/XT,
   41.    C   SUN, etc.)   (S.P.)        2          128        35.040
   42.    C IEEE (IBM/XT,
   43.    C   SUN, etc.)   (D.P.)        2         1024        171.624
   44.    C IBM 3033       (D.P.)       16           63        57.574
   45.    C VAX D-Format   (D.P.)        2          127        34.844
   46.    C VAX G-Format   (D.P.)        2         1023        171.489
   47.    C
   48.    C                            XINF         EPS        XMININ
   49.    C
   50.    C CRAY-1         (S.P.)   5.45E+2465   7.11E-15    1.84E-2466
   51.    C Cyber 180/855
   52.    C   under NOS    (S.P.)   1.26E+322    3.55E-15    3.14E-294
   53.    C IEEE (IBM/XT,
   54.    C   SUN, etc.)   (S.P.)   3.40E+38     1.19E-7     1.18E-38
   55.    C IEEE (IBM/XT,
   56.    C   SUN, etc.)   (D.P.)   1.79D+308    2.22D-16    2.23D-308
   57.    C IBM 3033       (D.P.)   7.23D+75     2.22D-16    1.39D-76
   58.    C VAX D-Format   (D.P.)   1.70D+38     1.39D-17    5.88D-39
   59.    C VAX G-Format   (D.P.)   8.98D+307    1.11D-16    1.12D-308
   60.    C
   61.    C*******************************************************************
   62.    C*******************************************************************
   63.    C
   64.    C Error returns
   65.    C
   66.    C  The program returns the value XINF for singularities or
   67.    C     when overflow would occur.  The computation is believed
   68.    C     to be free of underflow and overflow.
   69.    C
   70.    C
   71.    C  Intrinsic functions required are:
   72.    C
   73.    C     INT, DBLE, EXP, LOG, REAL, SIN
   74.    C
   75.    C
   76.    C References: "An Overview of Software Development for Special
   77.    C              Functions", W. J. Cody, Lecture Notes in Mathematics,
   78.    C              506, Numerical Analysis Dundee, 1975, G. A. Watson
   79.    C              (ed.), Springer Verlag, Berlin, 1976.
   80.    C
   81.    C              Computer Approximations, Hart, Et. Al., Wiley and
   82.    C              sons, New York, 1968.
   83.    C
   84.    C  Latest modification: October 12, 1989
   85.    C
   86.    C  Authors: W. J. Cody and L. Stoltz
   87.    C           Applied Mathematics Division
   88.    C           Argonne National Laboratory
   89.    C           Argonne, IL 60439
   90.    C
   91.    C----------------------------------------------------------------------
   92.          implicit none
   93.    
   94.          INTEGER I,N
   95.          LOGICAL PARITY
   96.    CS    REAL 
   97.          DOUBLE PRECISION 
   98.         1    C,CONV,EPS,FACT,HALF,ONE,P,PI,Q,RES,SQRTPI,SUM,TWELVE,
   99.         2    TWO,X,XBIG,XDEN,XINF,XMININ,XNUM,Y,Y1,YSQ,Z,ZERO
  100.          DIMENSION C(7),P(8),Q(8)
  101.    C----------------------------------------------------------------------
  102.    C  Mathematical constants
  103.    C----------------------------------------------------------------------
  104.    CS    DATA ONE,HALF,TWELVE,TWO,ZERO/1.0E0,0.5E0,12.0E0,2.0E0,0.0E0/,
  105.    CS   1     SQRTPI/0.9189385332046727417803297E0/,
  106.    CS   2     PI/3.1415926535897932384626434E0/
  107.          DATA ONE,HALF,TWELVE,TWO,ZERO/1.0D0,0.5D0,12.0D0,2.0D0,0.0D0/,
  108.         1     SQRTPI/0.9189385332046727417803297D0/,
  109.         2     PI/3.1415926535897932384626434D0/
  110.    C----------------------------------------------------------------------
  111.    C  Machine dependent parameters
  112.    C----------------------------------------------------------------------
  113.    CS    DATA XBIG,XMININ,EPS/35.040E0,1.18E-38,1.19E-7/,
  114.    CS   1     XINF/3.4E38/
  115.          DATA XBIG,XMININ,EPS/171.624D0,2.23D-308,2.22D-16/,
  116.         1     XINF/1.79D308/
  117.    C----------------------------------------------------------------------
  118.    C  Numerator and denominator coefficients for rational minimax
  119.    C     approximation over (1,2).
  120.    C----------------------------------------------------------------------
  121.    CS    DATA P/-1.71618513886549492533811E+0,2.47656508055759199108314E+1,
  122.    CS   1       -3.79804256470945635097577E+2,6.29331155312818442661052E+2,
  123.    CS   2       8.66966202790413211295064E+2,-3.14512729688483675254357E+4,
  124.    CS   3       -3.61444134186911729807069E+4,6.64561438202405440627855E+4/
  125.    CS    DATA Q/-3.08402300119738975254353E+1,3.15350626979604161529144E+2,
  126.    CS   1      -1.01515636749021914166146E+3,-3.10777167157231109440444E+3,
  127.    CS   2        2.25381184209801510330112E+4,4.75584627752788110767815E+3,
  128.    CS   3      -1.34659959864969306392456E+5,-1.15132259675553483497211E+5/
  129.          DATA P/-1.71618513886549492533811D+0,2.47656508055759199108314D+1,
  130.         1       -3.79804256470945635097577D+2,6.29331155312818442661052D+2,
  131.         2       8.66966202790413211295064D+2,-3.14512729688483675254357D+4,
  132.         3       -3.61444134186911729807069D+4,6.64561438202405440627855D+4/
  133.          DATA Q/-3.08402300119738975254353D+1,3.15350626979604161529144D+2,
  134.         1      -1.01515636749021914166146D+3,-3.10777167157231109440444D+3,
  135.         2        2.25381184209801510330112D+4,4.75584627752788110767815D+3,
  136.         3      -1.34659959864969306392456D+5,-1.15132259675553483497211D+5/
  137.    C----------------------------------------------------------------------
  138.    C  Coefficients for minimax approximation over (12, INF).
  139.    C----------------------------------------------------------------------
  140.    CS    DATA C/-1.910444077728E-03,8.4171387781295E-04,
  141.    CS   1     -5.952379913043012E-04,7.93650793500350248E-04,
  142.    CS   2     -2.777777777777681622553E-03,8.333333333333333331554247E-02,
  143.    CS   3      5.7083835261E-03/
  144.          DATA C/-1.910444077728D-03,8.4171387781295D-04,
  145.         1     -5.952379913043012D-04,7.93650793500350248D-04,
  146.         2     -2.777777777777681622553D-03,8.333333333333333331554247D-02,
  147.         3      5.7083835261D-03/
  148.    C----------------------------------------------------------------------
  149.    C  Statement functions for conversion between integer and float
  150.    C----------------------------------------------------------------------
  151.    CS    CONV(I) = REAL(I)
  152.          CONV(I) = DBLE(I)
  153.          PARITY = .FALSE.
  154.          FACT = ONE
  155.          N = 0
  156.          Y = X
  157.          IF (Y .LE. ZERO) THEN
  158.    C----------------------------------------------------------------------
  159.    C  Argument is negative
  160.    C----------------------------------------------------------------------
  161.                Y = -X
  162.                Y1 = AINT(Y)
  163.                RES = Y - Y1
  164.                IF (RES .NE. ZERO) THEN
  165.                      IF (Y1 .NE. AINT(Y1*HALF)*TWO) PARITY = .TRUE.
  166.                      FACT = -PI / SIN(PI*RES)
  167.                      Y = Y + ONE
  168.                   ELSE
  169.                      RES = XINF
  170.                      GO TO 900
  171.                END IF
  172.          END IF
  173.    C----------------------------------------------------------------------
  174.    C  Argument is positive
  175.    C----------------------------------------------------------------------
  176.          IF (Y .LT. EPS) THEN
  177.    C----------------------------------------------------------------------
  178.    C  Argument .LT. EPS
  179.    C----------------------------------------------------------------------
  180.                IF (Y .GE. XMININ) THEN
  181.                      RES = ONE / Y
  182.                   ELSE
  183.                      RES = XINF
  184.                      GO TO 900
  185.                END IF
  186.             ELSE IF (Y .LT. TWELVE) THEN
  187.                Y1 = Y
  188.                IF (Y .LT. ONE) THEN
  189.    C----------------------------------------------------------------------
  190.    C  0.0 .LT. argument .LT. 1.0
  191.    C----------------------------------------------------------------------
  192.                      Z = Y
  193.                      Y = Y + ONE
  194.                   ELSE
  195.    C----------------------------------------------------------------------
  196.    C  1.0 .LT. argument .LT. 12.0, reduce argument if necessary
  197.    C----------------------------------------------------------------------
  198.                      N = INT(Y) - 1
  199.                      Y = Y - CONV(N)
  200.                      Z = Y - ONE
  201.                END IF
  202.    C----------------------------------------------------------------------
  203.    C  Evaluate approximation for 1.0 .LT. argument .LT. 2.0
  204.    C----------------------------------------------------------------------
  205.                XNUM = ZERO
  206.                XDEN = ONE
  207.                DO 260 I = 1, 8
  208.                   XNUM = (XNUM + P(I)) * Z
  209.                   XDEN = XDEN * Z + Q(I)
  210.      260       CONTINUE
  211.                RES = XNUM / XDEN + ONE
  212.                IF (Y1 .LT. Y) THEN
  213.    C----------------------------------------------------------------------
  214.    C  Adjust result for case  0.0 .LT. argument .LT. 1.0
  215.    C----------------------------------------------------------------------
  216.                      RES = RES / Y1
  217.                   ELSE IF (Y1 .GT. Y) THEN
  218.    C----------------------------------------------------------------------
  219.    C  Adjust result for case  2.0 .LT. argument .LT. 12.0
  220.    C----------------------------------------------------------------------
  221.                      DO 290 I = 1, N
  222.                         RES = RES * Y
  223.                         Y = Y + ONE
  224.      290             CONTINUE
  225.                END IF
  226.             ELSE
  227.    C----------------------------------------------------------------------
  228.    C  Evaluate for argument .GE. 12.0,
  229.    C----------------------------------------------------------------------
  230.                IF (Y .LE. XBIG) THEN
  231.                      YSQ = Y * Y
  232.                      SUM = C(7)
  233.                      DO 350 I = 1, 6
  234.                         SUM = SUM / YSQ + C(I)
  235.      350             CONTINUE
  236.                      SUM = SUM/Y - Y + SQRTPI
  237.                      SUM = SUM + (Y-HALF)*LOG(Y)
  238.                      RES = EXP(SUM)
  239.                   ELSE
  240.                      RES = XINF
  241.                      GO TO 900
  242.                END IF
  243.          END IF
  244.    C----------------------------------------------------------------------
  245.    C  Final adjustments and return
  246.    C----------------------------------------------------------------------
  247.          IF (PARITY) RES = -RES
  248.          IF (FACT .NE. ONE) RES = FACT / RES
  249.    CS900 GAMMA = RES
  250.      900 DGAMMA = RES
  251.          RETURN
  252.    C ---------- Last line of GAMMA ----------
  253.          END


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
AINT(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   DGAMMA (Line 162, file gamma.f)
                   DGAMMA (Line 165, file gamma.f)

Name  Messages
----  --------
DBLE(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   DGAMMA (Line 152, file gamma.f)
                   DGAMMA (Line 199, file gamma.f)

Name  Messages
----  --------
DGAMMA
      Defined as:  Function (line 2, file gamma.f)

      Interface:   None

      Calls:       AINT(Intrinsic) (Line 162, file gamma.f)
                   AINT(Intrinsic) (Line 165, file gamma.f)
                   SIN(Intrinsic) (Line 166, file gamma.f)
                   INT(Intrinsic) (Line 198, file gamma.f)
                   DBLE(Intrinsic) (Line 152, file gamma.f)
                   DBLE(Intrinsic) (Line 199, file gamma.f)
                   LOG(Intrinsic) (Line 237, file gamma.f)
                   EXP(Intrinsic) (Line 238, file gamma.f)

Name  Messages
----  --------
EXP(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   DGAMMA (Line 238, file gamma.f)

Name  Messages
----  --------
INT(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   DGAMMA (Line 198, file gamma.f)

Name  Messages
----  --------
LOG(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   DGAMMA (Line 237, file gamma.f)

Name  Messages
----  --------
SIN(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   DGAMMA (Line 166, file gamma.f)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
