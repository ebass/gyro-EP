%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gyro-EP/shared/math/j0y0.f
Compiled : 01/19/21  14:38:38
Compiler : Version 9.1.0
Ftnlx    : Version 9.1.0 
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hdynamic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -hnoomp -em
           -J/global/homes/b/bassem/gyro-EP/modules -eD -Ktrap=fp -m1 -Rbcdps
           -c j0y0.f
           -I/opt/cray/pe/cce/9.1.0/cce-clang/x86_64/lib/clang/9.0.0/include
           -I/opt/cray/pe/cce/9.1.0/cce/x86_64/include/craylibs -I/usr/include
           -I/usr/include -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -I/opt/cray/pe/libsci/19.06.1/CRAY/9.0/x86_64/include
           -I/opt/cray/pe/mpt/7.7.10/gni/mpich-cray/9.0/include
           -I/opt/cray/pe/hdf5/1.10.5.2/cray/9.0/include
           -I/opt/cray/pe/netcdf/4.6.3.2/cray/9.0/include
           -I/opt/cray/rca/2.2.20-7.0.1.1_4.53__g8e3fb5b.ari/include
           -I/opt/cray/alps/6.6.58-7.0.1.1_6.10__g437d88db.ari/include
           -I/opt/cray/xpmem/2.2.20-7.0.1.1_4.14__g0475745.ari/include
           -I/opt/cray/gni-headers/5.0.12.0-7.0.1.1_6.32__g3b1768f.ari/include
           -I/opt/cray/dmapp/7.1.1-7.0.1.1_4.54__g38cf134.ari/include
           -I/opt/cray/pe/pmi/5.0.14/include
           -I/opt/cray/ugni/6.0.14.0-7.0.1.1_7.40__ge78e5b0.ari/include
           -I/opt/cray/udreg/2.3.2-7.0.1.1_3.38__g8175d3d.ari/include
           -I/opt/cray/wlm_detect/1.3.3-7.0.1.1_4.16__g7109084.ari/include
           -I/opt/cray/krca/2.2.6-7.0.1.1_5.39__gb641b12.ari/include
           -I/opt/cray-hss-devel/9.0.0/include
Program
  Units  : CALJY0
          BESJ0
          BESY0

ftnlx report
------------
Source   : /global/u2/b/bassem/gyro-EP/shared/math/j0y0.f
Date     : 01/19/2021  14:38:38


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.          SUBROUTINE CALJY0(ARG,RESULT,JINT)
    2.    C---------------------------------------------------------------------
    3.    C
    4.    C This packet computes zero-order Bessel functions of the first and
    5.    C   second kind (J0 and Y0), for real arguments X, where 0 < X <= XMAX
    6.    C   for Y0, and |X| <= XMAX for J0.  It contains two function-type
    7.    C   subprograms,  BESJ0  and  BESY0,  and one subroutine-type
    8.    C   subprogram,  CALJY0.  The calling statements for the primary
    9.    C   entries are:
   10.    C
   11.    C           Y = BESJ0(X)
   12.    C   and
   13.    C           Y = BESY0(X),
   14.    C
   15.    C   where the entry points correspond to the functions J0(X) and Y0(X),
   16.    C   respectively.  The routine  CALJY0  is intended for internal packet
   17.    C   use only, all computations within the packet being concentrated in
   18.    C   this one routine.  The function subprograms invoke  CALJY0  with
   19.    C   the statement
   20.    C           CALL CALJY0(ARG,RESULT,JINT),
   21.    C   where the parameter usage is as follows:
   22.    C
   23.    C      Function                  Parameters for CALJY0
   24.    C       call              ARG             RESULT          JINT
   25.    C
   26.    C     BESJ0(ARG)     |ARG| .LE. XMAX       J0(ARG)          0
   27.    C     BESY0(ARG)   0 .LT. ARG .LE. XMAX    Y0(ARG)          1
   28.    C
   29.    C   The main computation uses unpublished minimax rational
   30.    C   approximations for X .LE. 8.0, and an approximation from the 
   31.    C   book  Computer Approximations  by Hart, et. al., Wiley and Sons, 
   32.    C   New York, 1968, for arguments larger than 8.0   Part of this
   33.    C   transportable packet is patterned after the machine-dependent
   34.    C   FUNPACK program BESJ0(X), but cannot match that version for
   35.    C   efficiency or accuracy.  This version uses rational functions
   36.    C   that are theoretically accurate to at least 18 significant decimal
   37.    C   digits for X <= 8, and at least 18 decimal places for X > 8.  The
   38.    C   accuracy achieved depends on the arithmetic system, the compiler,
   39.    C   the intrinsic functions, and proper selection of the machine-
   40.    C   dependent constants.
   41.    C
   42.    C*******************************************************************
   43.    C
   44.    C Explanation of machine-dependent constants
   45.    C
   46.    C   XINF   = largest positive machine number
   47.    C   XMAX   = largest acceptable argument.  The functions AINT, SIN
   48.    C            and COS must perform properly for  ABS(X) .LE. XMAX.
   49.    C            We recommend that XMAX be a small integer multiple of
   50.    C            sqrt(1/eps), where eps is the smallest positive number
   51.    C            such that  1+eps > 1. 
   52.    C   XSMALL = positive argument such that  1.0-(X/2)**2 = 1.0
   53.    C            to machine precision for all  ABS(X) .LE. XSMALL.
   54.    C            We recommend that  XSMALL < sqrt(eps)/beta, where beta
   55.    C            is the floating-point radix (usually 2 or 16).
   56.    C
   57.    C     Approximate values for some important machines are
   58.    C
   59.    C                          eps      XMAX     XSMALL      XINF  
   60.    C
   61.    C  CDC 7600      (S.P.)  7.11E-15  1.34E+08  2.98E-08  1.26E+322
   62.    C  CRAY-1        (S.P.)  7.11E-15  1.34E+08  2.98E-08  5.45E+2465
   63.    C  IBM PC (8087) (S.P.)  5.96E-08  8.19E+03  1.22E-04  3.40E+38
   64.    C  IBM PC (8087) (D.P.)  1.11D-16  2.68D+08  3.72D-09  1.79D+308
   65.    C  IBM 195       (D.P.)  2.22D-16  6.87D+09  9.09D-13  7.23D+75
   66.    C  UNIVAC 1108   (D.P.)  1.73D-18  4.30D+09  2.33D-10  8.98D+307
   67.    C  VAX 11/780    (D.P.)  1.39D-17  1.07D+09  9.31D-10  1.70D+38
   68.    C
   69.    C*******************************************************************
   70.    C*******************************************************************
   71.    C
   72.    C Error Returns
   73.    C
   74.    C  The program returns the value zero for  X .GT. XMAX, and returns
   75.    C    -XINF when BESLY0 is called with a negative or zero argument.
   76.    C
   77.    C
   78.    C Intrinsic functions required are:
   79.    C
   80.    C     ABS, AINT, COS, LOG, SIN, SQRT
   81.    C
   82.    C
   83.    C  Latest modification: June 2, 1989
   84.    C
   85.    C  Author: W. J. Cody
   86.    C          Mathematics and Computer Science Division 
   87.    C          Argonne National Laboratory
   88.    C          Argonne, IL 60439
   89.    C
   90.    C--------------------------------------------------------------------
   91.          INTEGER I,JINT
   92.    C      REAL
   93.          DOUBLE PRECISION
   94.         1       ARG,AX,CONS,DOWN,EIGHT,FIVE5,FOUR,ONE,ONEOV8,PI2,PJ0,
   95.         2       PJ1,PLG,PROD,PY0,PY1,PY2,P0,P1,P17,QJ0,QJ1,QLG,QY0,QY1,
   96.         3       QY2,Q0,Q1,RESJ,RESULT,R0,R1,SIXTY4,THREE,TWOPI,TWOPI1,
   97.         4       TWOPI2,TWO56,UP,W,WSQ,XDEN,XINF,XMAX,XNUM,XSMALL,XJ0,
   98.         5       XJ1,XJ01,XJ02,XJ11,XJ12,XY,XY0,XY01,XY02,XY1,XY11,XY12,
   99.         6       XY2,XY21,XY22,Z,ZERO,ZSQ
  100.          DIMENSION PJ0(7),PJ1(8),PLG(4),PY0(6),PY1(7),PY2(8),P0(6),P1(6),
  101.         1          QJ0(5),QJ1(7),QLG(4),QY0(5),QY1(6),QY2(7),Q0(5),Q1(5)
  102.    C-------------------------------------------------------------------
  103.    C  Mathematical constants
  104.    C    CONS = ln(.5) + Euler's gamma
  105.    C-------------------------------------------------------------------
  106.    C      DATA ZERO,ONE,THREE,FOUR,EIGHT/0.0E0,1.0E0,3.0E0,4.0E0,8.0E0/,
  107.    C     1     FIVE5,SIXTY4,ONEOV8,P17/5.5E0,64.0E0,0.125E0,1.716E-1/,
  108.    C     2     TWO56,CONS/256.0E0,-1.1593151565841244881E-1/,
  109.    C     3     PI2,TWOPI/6.3661977236758134308E-1,6.2831853071795864769E0/,
  110.    C     4     TWOPI1,TWOPI2/6.28125E0,1.9353071795864769253E-3/
  111.          DATA ZERO,ONE,THREE,FOUR,EIGHT/0.0D0,1.0D0,3.0D0,4.0D0,8.0D0/,
  112.         1     FIVE5,SIXTY4,ONEOV8,P17/5.5D0,64.0D0,0.125D0,1.716D-1/,
  113.         2     TWO56,CONS/256.0D0,-1.1593151565841244881D-1/,
  114.         3     PI2,TWOPI/6.3661977236758134308D-1,6.2831853071795864769D0/,
  115.         4     TWOPI1,TWOPI2/6.28125D0,1.9353071795864769253D-3/
  116.    C-------------------------------------------------------------------
  117.    C  Machine-dependent constants
  118.    C-------------------------------------------------------------------
  119.    C      DATA XMAX/8.19E+03/,XSMALL/1.22E-09/,XINF/1.7E+38/
  120.          DATA XMAX/1.07D+09/,XSMALL/9.31D-10/,XINF/1.7D+38/
  121.    C-------------------------------------------------------------------
  122.    C  Zeroes of Bessel functions
  123.    C-------------------------------------------------------------------
  124.    C      DATA XJ0/2.4048255576957727686E+0/,XJ1/5.5200781102863106496E+0/,
  125.    C     1     XY0/8.9357696627916752158E-1/,XY1/3.9576784193148578684E+0/,
  126.    C     2     XY2/7.0860510603017726976E+0/,
  127.    C     3     XJ01/ 616.0E+0/, XJ02/-1.4244423042272313784E-03/,
  128.    C     4     XJ11/1413.0E+0/, XJ12/ 5.4686028631064959660E-04/,
  129.    C     5     XY01/ 228.0E+0/, XY02/ 2.9519662791675215849E-03/,
  130.    C     6     XY11/1013.0E+0/, XY12/ 6.4716931485786837568E-04/,
  131.    C     7     XY21/1814.0E+0/, XY22/ 1.1356030177269762362E-04/
  132.          DATA XJ0/2.4048255576957727686D+0/,XJ1/5.5200781102863106496D+0/,
  133.         1     XY0/8.9357696627916752158D-1/,XY1/3.9576784193148578684D+0/,
  134.         2     XY2/7.0860510603017726976D+0/,
  135.         3     XJ01/ 616.0D+0/, XJ02/-1.4244423042272313784D-03/,
  136.         4     XJ11/1413.0D+0/, XJ12/ 5.4686028631064959660D-04/,
  137.         5     XY01/ 228.0D+0/, XY02/ 2.9519662791675215849D-03/,
  138.         6     XY11/1013.0D+0/, XY12/ 6.4716931485786837568D-04/,
  139.         7     XY21/1814.0D+0/, XY22/ 1.1356030177269762362D-04/
  140.    C-------------------------------------------------------------------
  141.    C  Coefficients for rational approximation to ln(x/a)
  142.    C--------------------------------------------------------------------
  143.    C      DATA PLG/-2.4562334077563243311E+01,2.3642701335621505212E+02,
  144.    C     1         -5.4989956895857911039E+02,3.5687548468071500413E+02/
  145.    C      DATA QLG/-3.5553900764052419184E+01,1.9400230218539473193E+02,
  146.    C     1         -3.3442903192607538956E+02,1.7843774234035750207E+02/
  147.          DATA PLG/-2.4562334077563243311D+01,2.3642701335621505212D+02,
  148.         1         -5.4989956895857911039D+02,3.5687548468071500413D+02/
  149.          DATA QLG/-3.5553900764052419184D+01,1.9400230218539473193D+02,
  150.         1         -3.3442903192607538956D+02,1.7843774234035750207D+02/
  151.    C-------------------------------------------------------------------
  152.    C  Coefficients for rational approximation of
  153.    C  J0(X) / (X**2 - XJ0**2),  XSMALL  <  |X|  <=  4.0
  154.    C--------------------------------------------------------------------
  155.    C      DATA PJ0/6.6302997904833794242E+06,-6.2140700423540120665E+08,
  156.    C     1         2.7282507878605942706E+10,-4.1298668500990866786E+11,
  157.    C     2        -1.2117036164593528341E-01, 1.0344222815443188943E+02,
  158.    C     3        -3.6629814655107086448E+04/
  159.    C      DATA QJ0/4.5612696224219938200E+05, 1.3985097372263433271E+08,
  160.    C     1         2.6328198300859648632E+10, 2.3883787996332290397E+12,
  161.    C     2         9.3614022392337710626E+02/
  162.          DATA PJ0/6.6302997904833794242D+06,-6.2140700423540120665D+08,
  163.         1         2.7282507878605942706D+10,-4.1298668500990866786D+11,
  164.         2        -1.2117036164593528341D-01, 1.0344222815443188943D+02,
  165.         3        -3.6629814655107086448D+04/
  166.          DATA QJ0/4.5612696224219938200D+05, 1.3985097372263433271D+08,
  167.         1         2.6328198300859648632D+10, 2.3883787996332290397D+12,
  168.         2         9.3614022392337710626D+02/
  169.    C-------------------------------------------------------------------
  170.    C  Coefficients for rational approximation of
  171.    C  J0(X) / (X**2 - XJ1**2),  4.0  <  |X|  <=  8.0
  172.    C-------------------------------------------------------------------
  173.    C      DATA PJ1/4.4176707025325087628E+03, 1.1725046279757103576E+04,
  174.    C     1         1.0341910641583726701E+04,-7.2879702464464618998E+03,
  175.    C     2        -1.2254078161378989535E+04,-1.8319397969392084011E+03,
  176.    C     3         4.8591703355916499363E+01, 7.4321196680624245801E+02/
  177.    C      DATA QJ1/3.3307310774649071172E+02,-2.9458766545509337327E+03,
  178.    C     1         1.8680990008359188352E+04,-8.4055062591169562211E+04,
  179.    C     2         2.4599102262586308984E+05,-3.5783478026152301072E+05,
  180.    C     3        -2.5258076240801555057E+01/
  181.          DATA PJ1/4.4176707025325087628D+03, 1.1725046279757103576D+04,
  182.         1         1.0341910641583726701D+04,-7.2879702464464618998D+03,
  183.         2        -1.2254078161378989535D+04,-1.8319397969392084011D+03,
  184.         3         4.8591703355916499363D+01, 7.4321196680624245801D+02/
  185.          DATA QJ1/3.3307310774649071172D+02,-2.9458766545509337327D+03,
  186.         1         1.8680990008359188352D+04,-8.4055062591169562211D+04,
  187.         2         2.4599102262586308984D+05,-3.5783478026152301072D+05,
  188.         3        -2.5258076240801555057D+01/
  189.    C-------------------------------------------------------------------
  190.    C  Coefficients for rational approximation of
  191.    C    (Y0(X) - 2 LN(X/XY0) J0(X)) / (X**2 - XY0**2),
  192.    C        XSMALL  <  |X|  <=  3.0
  193.    C--------------------------------------------------------------------
  194.    C      DATA PY0/1.0102532948020907590E+04,-2.1287548474401797963E+06,
  195.    C     1         2.0422274357376619816E+08,-8.3716255451260504098E+09,
  196.    C     2         1.0723538782003176831E+11,-1.8402381979244993524E+01/
  197.    C      DATA QY0/6.6475986689240190091E+02, 2.3889393209447253406E+05,
  198.    C     1         5.5662956624278251596E+07, 8.1617187777290363573E+09,
  199.    C     2         5.8873865738997033405E+11/
  200.          DATA PY0/1.0102532948020907590D+04,-2.1287548474401797963D+06,
  201.         1         2.0422274357376619816D+08,-8.3716255451260504098D+09,
  202.         2         1.0723538782003176831D+11,-1.8402381979244993524D+01/
  203.          DATA QY0/6.6475986689240190091D+02, 2.3889393209447253406D+05,
  204.         1         5.5662956624278251596D+07, 8.1617187777290363573D+09,
  205.         2         5.8873865738997033405D+11/
  206.    C-------------------------------------------------------------------
  207.    C  Coefficients for rational approximation of
  208.    C    (Y0(X) - 2 LN(X/XY1) J0(X)) / (X**2 - XY1**2),
  209.    C        3.0  <  |X|  <=  5.5
  210.    C--------------------------------------------------------------------
  211.    C      DATA PY1/-1.4566865832663635920E+04, 4.6905288611678631510E+06,
  212.    C     1         -6.9590439394619619534E+08, 4.3600098638603061642E+10,
  213.    C     2         -5.5107435206722644429E+11,-2.2213976967566192242E+13,
  214.    C     3          1.7427031242901594547E+01/
  215.    C      DATA QY1/ 8.3030857612070288823E+02, 4.0669982352539552018E+05,
  216.    C     1          1.3960202770986831075E+08, 3.4015103849971240096E+10,
  217.    C     2          5.4266824419412347550E+12, 4.3386146580707264428E+14/
  218.          DATA PY1/-1.4566865832663635920D+04, 4.6905288611678631510D+06,
  219.         1         -6.9590439394619619534D+08, 4.3600098638603061642D+10,
  220.         2         -5.5107435206722644429D+11,-2.2213976967566192242D+13,
  221.         3          1.7427031242901594547D+01/
  222.          DATA QY1/ 8.3030857612070288823D+02, 4.0669982352539552018D+05,
  223.         1          1.3960202770986831075D+08, 3.4015103849971240096D+10,
  224.         2          5.4266824419412347550D+12, 4.3386146580707264428D+14/
  225.    C-------------------------------------------------------------------
  226.    C  Coefficients for rational approximation of
  227.    C    (Y0(X) - 2 LN(X/XY2) J0(X)) / (X**2 - XY2**2),
  228.    C        5.5  <  |X|  <=  8.0
  229.    C--------------------------------------------------------------------
  230.    C      DATA PY2/ 2.1363534169313901632E+04,-1.0085539923498211426E+07,
  231.    C     1          2.1958827170518100757E+09,-1.9363051266772083678E+11,
  232.    C     2         -1.2829912364088687306E+11, 6.7016641869173237784E+14,
  233.    C     3         -8.0728726905150210443E+15,-1.7439661319197499338E+01/
  234.    C      DATA QY2/ 8.7903362168128450017E+02, 5.3924739209768057030E+05,
  235.    C     1          2.4727219475672302327E+08, 8.6926121104209825246E+10,
  236.    C     2          2.2598377924042897629E+13, 3.9272425569640309819E+15,
  237.    C     3          3.4563724628846457519E+17/
  238.          DATA PY2/ 2.1363534169313901632D+04,-1.0085539923498211426D+07,
  239.         1          2.1958827170518100757D+09,-1.9363051266772083678D+11,
  240.         2         -1.2829912364088687306D+11, 6.7016641869173237784D+14,
  241.         3         -8.0728726905150210443D+15,-1.7439661319197499338D+01/
  242.          DATA QY2/ 8.7903362168128450017D+02, 5.3924739209768057030D+05,
  243.         1          2.4727219475672302327D+08, 8.6926121104209825246D+10,
  244.         2          2.2598377924042897629D+13, 3.9272425569640309819D+15,
  245.         3          3.4563724628846457519D+17/
  246.    C-------------------------------------------------------------------
  247.    C  Coefficients for Hart,s approximation,  |X| > 8.0
  248.    C-------------------------------------------------------------------
  249.    C      DATA P0/3.4806486443249270347E+03, 2.1170523380864944322E+04,
  250.    C     1        4.1345386639580765797E+04, 2.2779090197304684302E+04,
  251.    C     2        8.8961548424210455236E-01, 1.5376201909008354296E+02/
  252.    C      DATA Q0/3.5028735138235608207E+03, 2.1215350561880115730E+04,
  253.    C     1        4.1370412495510416640E+04, 2.2779090197304684318E+04,
  254.    C     2        1.5711159858080893649E+02/
  255.    C      DATA P1/-2.2300261666214198472E+01,-1.1183429920482737611E+02,
  256.    C     1        -1.8591953644342993800E+02,-8.9226600200800094098E+01,
  257.    C     2        -8.8033303048680751817E-03,-1.2441026745835638459E+00/
  258.    C      DATA Q1/1.4887231232283756582E+03, 7.2642780169211018836E+03,
  259.    C     1        1.1951131543434613647E+04, 5.7105024128512061905E+03,
  260.    C     2        9.0593769594993125859E+01/
  261.          DATA P0/3.4806486443249270347D+03, 2.1170523380864944322D+04,
  262.         1        4.1345386639580765797D+04, 2.2779090197304684302D+04,
  263.         2        8.8961548424210455236D-01, 1.5376201909008354296D+02/
  264.          DATA Q0/3.5028735138235608207D+03, 2.1215350561880115730D+04,
  265.         1        4.1370412495510416640D+04, 2.2779090197304684318D+04,
  266.         2        1.5711159858080893649D+02/
  267.          DATA P1/-2.2300261666214198472D+01,-1.1183429920482737611D+02,
  268.         1        -1.8591953644342993800D+02,-8.9226600200800094098D+01,
  269.         2        -8.8033303048680751817D-03,-1.2441026745835638459D+00/
  270.          DATA Q1/1.4887231232283756582D+03, 7.2642780169211018836D+03,
  271.         1        1.1951131543434613647D+04, 5.7105024128512061905D+03,
  272.         2        9.0593769594993125859D+01/
  273.    C-------------------------------------------------------------------
  274.    C  Check for error conditions
  275.    C-------------------------------------------------------------------
  276.          AX = ABS(ARG)
  277.          IF ((JINT .EQ. 1) .AND. (ARG .LE. ZERO)) THEN
  278.                RESULT = -XINF
  279.                GO TO 2000
  280.             ELSE IF (AX .GT. XMAX) THEN
  281.                RESULT = ZERO
  282.                GO TO 2000
  283.          END IF
  284.          IF (AX .GT. EIGHT) GO TO 800
  285.          IF (AX .LE. XSMALL) THEN
  286.             IF (JINT .EQ. 0) THEN
  287.                   RESULT = ONE
  288.                ELSE
  289.                   RESULT = PI2 * (LOG(AX) + CONS)
  290.             END IF
  291.             GO TO 2000
  292.          END IF
  293.    C-------------------------------------------------------------------
  294.    C  Calculate J0 for appropriate interval, preserving
  295.    C     accuracy near the zero of J0
  296.    C-------------------------------------------------------------------
  297.          ZSQ = AX * AX
  298.          IF (AX .LE. FOUR) THEN
  299.                XNUM = (PJ0(5) * ZSQ + PJ0(6)) * ZSQ + PJ0(7)
  300.                XDEN = ZSQ + QJ0(5)
  301.                DO 50 I = 1, 4
  302.                   XNUM = XNUM * ZSQ + PJ0(I)
  303.                   XDEN = XDEN * ZSQ + QJ0(I)
  304.       50       CONTINUE
  305.                PROD = ((AX - XJ01/TWO56) - XJ02) * (AX + XJ0)
  306.             ELSE
  307.                WSQ = ONE - ZSQ / SIXTY4
  308.                XNUM = PJ1(7) * WSQ + PJ1(8)
  309.                XDEN = WSQ + QJ1(7)
  310.                DO 220 I = 1, 6
  311.                   XNUM = XNUM * WSQ + PJ1(I)
  312.                   XDEN = XDEN * WSQ + QJ1(I)
  313.      220       CONTINUE
  314.                PROD = (AX + XJ1) * ((AX - XJ11/TWO56) - XJ12)
  315.          END IF
  316.          RESULT = PROD * XNUM / XDEN
  317.          IF (JINT .EQ. 0) GO TO 2000
  318.    C-------------------------------------------------------------------
  319.    C  Calculate Y0.  First find  RESJ = pi/2 ln(x/xn) J0(x),
  320.    C    where xn is a zero of Y0
  321.    C-------------------------------------------------------------------
  322.          IF (AX .LE. THREE) THEN
  323.                UP = (AX-XY01/TWO56)-XY02
  324.                XY = XY0
  325.             ELSE IF (AX .LE. FIVE5) THEN
  326.                UP = (AX-XY11/TWO56)-XY12
  327.                XY = XY1
  328.             ELSE
  329.                UP = (AX-XY21/TWO56)-XY22
  330.                XY = XY2
  331.          END IF
  332.          DOWN = AX + XY
  333.          IF (ABS(UP) .LT. P17*DOWN) THEN
  334.                W = UP/DOWN
  335.                WSQ = W*W
  336.                XNUM = PLG(1)
  337.                XDEN = WSQ + QLG(1)
  338.                DO 320 I = 2, 4
  339.                   XNUM = XNUM*WSQ + PLG(I)
  340.                   XDEN = XDEN*WSQ + QLG(I)
  341.      320       CONTINUE
  342.                RESJ = PI2 * RESULT * W * XNUM/XDEN
  343.             ELSE
  344.                RESJ = PI2 * RESULT * LOG(AX/XY)
  345.          END IF
  346.    C-------------------------------------------------------------------
  347.    C  Now calculate Y0 for appropriate interval, preserving
  348.    C     accuracy near the zero of Y0
  349.    C-------------------------------------------------------------------
  350.          IF (AX .LE. THREE) THEN
  351.                XNUM = PY0(6) * ZSQ + PY0(1)
  352.                XDEN = ZSQ + QY0(1)
  353.                DO 340 I = 2, 5
  354.                   XNUM = XNUM * ZSQ + PY0(I)
  355.                   XDEN = XDEN * ZSQ + QY0(I)
  356.      340       CONTINUE
  357.             ELSE IF (AX .LE. FIVE5) THEN
  358.                XNUM = PY1(7) * ZSQ + PY1(1)
  359.                XDEN = ZSQ + QY1(1)
  360.                DO 360 I = 2, 6
  361.                   XNUM = XNUM * ZSQ + PY1(I)
  362.                   XDEN = XDEN * ZSQ + QY1(I)
  363.      360       CONTINUE
  364.             ELSE
  365.                XNUM = PY2(8) * ZSQ + PY2(1)
  366.                XDEN = ZSQ + QY2(1)
  367.                DO 380 I = 2, 7
  368.                   XNUM = XNUM * ZSQ + PY2(I)
  369.                   XDEN = XDEN * ZSQ + QY2(I)
  370.      380       CONTINUE
  371.          END IF
  372.          RESULT = RESJ + UP * DOWN * XNUM / XDEN
  373.          GO TO 2000
  374.    C-------------------------------------------------------------------
  375.    C  Calculate J0 or Y0 for |ARG|  >  8.0
  376.    C-------------------------------------------------------------------
  377.      800 Z = EIGHT / AX
  378.          W = AX / TWOPI
  379.          W = AINT(W) + ONEOV8
  380.          W = (AX - W * TWOPI1) - W * TWOPI2
  381.          ZSQ = Z * Z
  382.          XNUM = P0(5) * ZSQ + P0(6)
  383.          XDEN = ZSQ + Q0(5)
  384.          UP = P1(5) * ZSQ + P1(6)
  385.          DOWN = ZSQ + Q1(5)
  386.          DO 850 I = 1, 4
  387.             XNUM = XNUM * ZSQ + P0(I)
  388.             XDEN = XDEN * ZSQ + Q0(I)
  389.             UP = UP * ZSQ + P1(I)
  390.             DOWN = DOWN * ZSQ + Q1(I)
  391.      850 CONTINUE
  392.          R0 = XNUM / XDEN
  393.          R1 = UP / DOWN
  394.          IF (JINT .EQ. 0) THEN
  395.                RESULT = SQRT(PI2/AX) * (R0*COS(W) - Z*R1*SIN(W))
  396.             ELSE
  397.                RESULT = SQRT(PI2/AX) * (R0*SIN(W) + Z*R1*COS(W))
  398.          END IF
  399.     2000 RETURN
  400.    C---------- Last line of CALJY0 ----------
  401.          END


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  402.          DOUBLE PRECISION FUNCTION BESJ0(X)
  403.    C      REAL FUNCTION BESJ0(X)
  404.    C--------------------------------------------------------------------
  405.    C
  406.    C This subprogram computes approximate values for Bessel functions
  407.    C   of the first kind of order zero for arguments  |X| <= XMAX
  408.    C   (see comments heading CALJY0).
  409.    C
  410.    C--------------------------------------------------------------------
  411.          INTEGER JINT
  412.    C      REAL  X, RESULT
  413.          DOUBLE PRECISION  X, RESULT
  414.    C--------------------------------------------------------------------
  415.          JINT=0
  416.          CALL CALJY0(X,RESULT,JINT)
  417.          BESJ0 = RESULT
  418.          RETURN
  419.    C---------- Last line of BESJ0 ----------
  420.          END


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

  421.          DOUBLE PRECISION FUNCTION BESY0(X)
  422.    C      REAL FUNCTION BESY0(X)
  423.    C--------------------------------------------------------------------
  424.    C
  425.    C This subprogram computes approximate values for Bessel functions
  426.    C   of the second kind of order zero for arguments 0 < X <= XMAX
  427.    C   (see comments heading CALJY0).
  428.    C
  429.    C--------------------------------------------------------------------
  430.          INTEGER JINT
  431.    C      REAL  X, RESULT
  432.          DOUBLE PRECISION  X, RESULT
  433.    C--------------------------------------------------------------------
  434.          JINT=1
  435.          CALL CALJY0(X,RESULT,JINT)
  436.          BESY0 = RESULT
  437.          RETURN
  438.    C---------- Last line of BESY0 ----------
  439.          END


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
ABS(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   BESJ0 (Line 276, file j0y0.f)
                   BESJ0 (Line 333, file j0y0.f)

Name  Messages
----  --------
AINT(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   BESJ0 (Line 379, file j0y0.f)

Name  Messages
----  --------
BESJ0
      Defined as:  Function (line 402, file j0y0.f)

      Interface:   None

      Calls:       CALJY0 (Line 416, file j0y0.f)

Name  Messages
----  --------
BESY0
      Defined as:  Function (line 421, file j0y0.f)

      Interface:   None

      Calls:       CALJY0 (Line 435, file j0y0.f)

Name  Messages
----  --------
CALJY0
      Defined as:  Subroutine (line 1, file j0y0.f)

      Interface:   None

      Called By:   SIN(Intrinsic) (Line 416, file j0y0.f)
                   SQRT(Intrinsic) (Line 435, file j0y0.f)

      Calls:       ABS(Intrinsic) (Line 276, file j0y0.f)
                   ABS(Intrinsic) (Line 333, file j0y0.f)
                   LOG(Intrinsic) (Line 289, file j0y0.f)
                   LOG(Intrinsic) (Line 344, file j0y0.f)
                   AINT(Intrinsic) (Line 379, file j0y0.f)
                   SQRT(Intrinsic) (Line 395, file j0y0.f)
                   SQRT(Intrinsic) (Line 397, file j0y0.f)
                   COS(Intrinsic) (Line 395, file j0y0.f)
                   COS(Intrinsic) (Line 397, file j0y0.f)
                   SIN(Intrinsic) (Line 395, file j0y0.f)
                   SIN(Intrinsic) (Line 397, file j0y0.f)

Name  Messages
----  --------
COS(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   BESJ0 (Line 395, file j0y0.f)
                   BESJ0 (Line 397, file j0y0.f)

Name  Messages
----  --------
LOG(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   BESJ0 (Line 289, file j0y0.f)
                   BESJ0 (Line 344, file j0y0.f)

Name  Messages
----  --------
SIN(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   BESJ0 (Line 395, file j0y0.f)
                   BESJ0 (Line 397, file j0y0.f)

Name  Messages
----  --------
SQRT(Intrinsic)
      Defined as:  No definitions.

      Interface:   None

      Called By:   BESJ0 (Line 395, file j0y0.f)
                   BESJ0 (Line 397, file j0y0.f)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
