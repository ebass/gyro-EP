%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S u m m a r y   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Compilation
-----------
File     : /global/u2/b/bassem/gyro-EP/shared/math/gauss_integ.f90
Compiled : 01/19/21  14:38:38
Compiler : Version 9.1.0
Ftnlx    : Version 9.1.0 
Target   : x86-64
Command  : ftn_driver.exe -hcpu=haswell -hdynamic -D__CRAYXC -D__CRAY_HASWELL
           -D__CRAYXT_COMPUTE_LINUX_TARGET -hnetwork=aries -hnoomp -em
           -J/global/homes/b/bassem/gyro-EP/modules -sreal64 -eD -Ktrap=fp -m1
           -Rbcdps -c gauss_integ.f90
           -I/opt/cray/pe/cce/9.1.0/cce-clang/x86_64/lib/clang/9.0.0/include
           -I/opt/cray/pe/cce/9.1.0/cce/x86_64/include/craylibs -I/usr/include
           -I/usr/include -I/opt/cray/pe/fftw/3.3.8.4/haswell/include
           -I/opt/cray/pe/libsci/19.06.1/CRAY/9.0/x86_64/include
           -I/opt/cray/pe/mpt/7.7.10/gni/mpich-cray/9.0/include
           -I/opt/cray/pe/hdf5/1.10.5.2/cray/9.0/include
           -I/opt/cray/pe/netcdf/4.6.3.2/cray/9.0/include
           -I/opt/cray/rca/2.2.20-7.0.1.1_4.53__g8e3fb5b.ari/include
           -I/opt/cray/alps/6.6.58-7.0.1.1_6.10__g437d88db.ari/include
           -I/opt/cray/xpmem/2.2.20-7.0.1.1_4.14__g0475745.ari/include
           -I/opt/cray/gni-headers/5.0.12.0-7.0.1.1_6.32__g3b1768f.ari/include
           -I/opt/cray/dmapp/7.1.1-7.0.1.1_4.54__g38cf134.ari/include
           -I/opt/cray/pe/pmi/5.0.14/include
           -I/opt/cray/ugni/6.0.14.0-7.0.1.1_7.40__ge78e5b0.ari/include
           -I/opt/cray/udreg/2.3.2-7.0.1.1_3.38__g8175d3d.ari/include
           -I/opt/cray/wlm_detect/1.3.3-7.0.1.1_4.16__g7109084.ari/include
           -I/opt/cray/krca/2.2.6-7.0.1.1_5.39__gb641b12.ari/include
           -I/opt/cray-hss-devel/9.0.0/include
Program
  Units  : GAUSS_INTEG

ftnlx report
------------
Source   : /global/u2/b/bassem/gyro-EP/shared/math/gauss_integ.f90
Date     : 01/19/2021  14:38:38


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                          S o u r c e   L i s t i n g
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

    1.    subroutine gauss_integ(xmin,xmax,func,order,n_subdiv,answer)
    2.    
    3.      implicit none
    4.    
    5.      !--------------------------------------------
    6.      ! Subroutine arguments
    7.      !
    8.      real, intent(in) :: xmin
    9.      real, intent(in) :: xmax
   10.      real :: func
   11.      integer, intent(in) :: order
   12.      integer, intent(in) :: n_subdiv
   13.      !
   14.      real, intent(inout) :: answer
   15.      !--------------------------------------------
   16.    
   17.      !--------------------------------------------
   18.      ! Internal variables
   19.      !
   20.      integer :: n_node
   21.      integer :: i
   22.      integer :: j
   23.      integer :: p
   24.      !
   25.      real :: dx
   26.      !
   27.      real, dimension(:), allocatable :: x
   28.      real, dimension(:), allocatable :: w
   29.      real, dimension(:), allocatable :: x0
   30.      real, dimension(:), allocatable :: w0
   31.      !--------------------------------------------
   32.    
   33.      allocate(x0(order))
   34.      allocate(w0(order))
   35.      call gauss_legendre(0.0,1.0,x0,w0,order)     
   36.    
   37.      dx = (xmax-xmin)/n_subdiv
   38.    
   39.      n_node = n_subdiv*order
   40.    
   41.      allocate(x(n_node))
   42.      allocate(w(n_node))
   43.    
   44.      do i=1,n_subdiv
   45.         do j=1,order
   46.            p = (i-1)*order+j
   47.            x(p) = xmin+((i-1)+x0(j))*dx
   48.            w(p) = w0(j)*dx
   49.         enddo
   50.      enddo
   51.    
   52.      answer = 0.0
   53.      do p=1,n_node
   54.         answer = answer+w(p)*func(x(p))
   55.      enddo
   56.    
   57.      deallocate(x)
   58.      deallocate(w)
   59.      deallocate(x0)
   60.      deallocate(w0)
   61.    
   62.    end subroutine  gauss_integ


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                         E x t e r n a l   R e p o r t
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Name  Messages
----  --------
FUNC
      Defined as:  No definitions.

      Interface:   None

      Called By:   GAUSS_INTEG (Line 54, file gauss_integ.f90)

Name  Messages
----  --------
GAUSS_INTEG
      Defined as:  Subroutine (line 1, file gauss_integ.f90)

      Interface:   None

      Calls:       FUNC (Line 54, file gauss_integ.f90)

Name  Messages
----  --------
GAUSS_LEGENDRE
      Defined as:  No definitions.

                   No calls.  It is not called and does not use any procedure.

      Interface:   None


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
